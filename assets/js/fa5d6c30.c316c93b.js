"use strict";(self.webpackChunktreasure_house=self.webpackChunktreasure_house||[]).push([[8115],{2648:e=>{e.exports=JSON.parse('{"permalink":"/blog/2025-10-21-Deploy-Elastic-SIEM","editUrl":"https://github.com/Randark-JMT/Treasure-House/edit/main/blog/2025-10-21-Deploy-Elastic-SIEM/index.md","source":"@site/blog/2025-10-21-Deploy-Elastic-SIEM/index.md","title":"\u90e8\u7f72 Elastic SIEM","description":"\u672c\u6587\u7ae0\u4ecb\u7ecd Elastic SIEM \u5e73\u53f0\u90e8\u7f72\u4e0e\u4f7f\u7528","date":"2025-10-21T00:00:00.000Z","tags":[],"readingTime":7.34,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://randark.site/img/logo.jpg","key":"Randark","page":null}],"frontMatter":{"slug":"2025-10-21-Deploy-Elastic-SIEM","title":"\u90e8\u7f72 Elastic SIEM","authors":"Randark","tags":[]},"unlisted":false,"nextItem":{"title":"Viper Docker \u955c\u50cf\u5206\u6790","permalink":"/blog/2025-10-02-VIper-Docker-Image-Analysis"}}')},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>c});var t=s(6540);const a={},i=t.createContext(a);function r(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(i.Provider,{value:n},e.children)}},8613:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20251000-220040-58b052bf37190db03ae5758ad67d32c4.png"},8911:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>t,toc:()=>o});var t=s(2648),a=s(4848),i=s(8453);const r={slug:"2025-10-21-Deploy-Elastic-SIEM",title:"\u90e8\u7f72 Elastic SIEM",authors:"Randark",tags:[]},c=void 0,l={authorsImageUrls:[void 0]},o=[{value:"\u90e8\u7f72 Elasticsearch",id:"\u90e8\u7f72-elasticsearch",level:2},{value:"\u914d\u7f6e Elasticsearch",id:"\u914d\u7f6e-elasticsearch",level:2},{value:"\u914d\u7f6e Elasticsearch \u670d\u52a1",id:"\u914d\u7f6e-elasticsearch-\u670d\u52a1",level:2},{value:"\u5b89\u88c5 Kibana \u5e76\u914d\u7f6e",id:"\u5b89\u88c5-kibana-\u5e76\u914d\u7f6e",level:2},{value:"\u4e3a Kibana \u751f\u6210\u52a0\u5bc6 key",id:"\u4e3a-kibana-\u751f\u6210\u52a0\u5bc6-key",level:2},{value:"Reference",id:"reference",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"\u672c\u6587\u7ae0\u4ecb\u7ecd Elastic SIEM \u5e73\u53f0\u90e8\u7f72\u4e0e\u4f7f\u7528"}),"\n",(0,a.jsxs)(n.p,{children:["\u672c\u6587\u57fa\u4e8e ",(0,a.jsx)(n.code,{children:"Ubuntu Server 24.04.3"})," \u8fdb\u884c\u90e8\u7f72"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"randark@elastic-server:~$ lsb_release -a\nNo LSB modules are available.\nDistributor ID: Ubuntu\nDescription:    Ubuntu 24.04.3 LTS\nRelease:        24.04\nCodename:       noble\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u90e8\u7f72-elasticsearch",children:"\u90e8\u7f72 Elasticsearch"}),"\n",(0,a.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,a.jsx)(n.a,{href:"https://www.elastic.co/docs/deploy-manage/deploy/self-managed/install-elasticsearch-with-debian-package",children:"Install Elasticsearch from archive on Linux or MacOS | Elastic Docs"})]}),"\n",(0,a.jsx)(n.p,{children:"\u6267\u884c"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg\nsudo apt update\nsudo apt-get install apt-transport-https\necho "deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/9.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-9.x.list\n# \u6dfb\u52a0 Elastic APT \u4ed3\u5e93\nsudo apt-get update && sudo apt-get install elasticsearch\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u7406\u8bba\u4e0a\u5e94\u5f53\u770b\u5230"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"randark@elastic-server:~$ wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg\nrandark@elastic-server:~$ sudo apt update\nGet:4 http://security.ubuntu.com/ubuntu noble-security InRelease [126 kB]\nHit:1 http://mirrors.tuna.tsinghua.edu.cn/ubuntu noble InRelease                              \nHit:2 http://mirrors.tuna.tsinghua.edu.cn/ubuntu noble-updates InRelease                      \nHit:3 http://mirrors.tuna.tsinghua.edu.cn/ubuntu noble-backports InRelease\nGet:5 http://security.ubuntu.com/ubuntu noble-security/main amd64 Components [21.6 kB]\nGet:6 http://security.ubuntu.com/ubuntu noble-security/restricted amd64 Components [212 B]\nGet:7 http://security.ubuntu.com/ubuntu noble-security/universe amd64 Components [52.3 kB]\nGet:8 http://security.ubuntu.com/ubuntu noble-security/multiverse amd64 Components [208 B]                                                                                                                     \nFetched 200 kB in 7s (29.6 kB/s)                                                                                                                                                                               \nReading package lists... Done\nBuilding dependency tree... Done\nReading state information... Done\n28 packages can be upgraded. Run 'apt list --upgradable' to see them.\nrandark@elastic-server:~$ sudo apt-get install apt-transport-https\nReading package lists... Done\nBuilding dependency tree... Done\nReading state information... Done\nThe following NEW packages will be installed:\n  apt-transport-https\n0 upgraded, 1 newly installed, 0 to remove and 28 not upgraded.\nNeed to get 3,970 B of archives.\nAfter this operation, 36.9 kB of additional disk space will be used.\nGet:1 http://mirrors.tuna.tsinghua.edu.cn/ubuntu noble-updates/universe amd64 apt-transport-https all 2.8.3 [3,970 B]\nFetched 3,970 B in 1s (5,139 B/s)               \nSelecting previously unselected package apt-transport-https.\n(Reading database ... 87290 files and directories currently installed.)\nPreparing to unpack .../apt-transport-https_2.8.3_all.deb ...\nUnpacking apt-transport-https (2.8.3) ...\nSetting up apt-transport-https (2.8.3) ...\nScanning processes...                                                                                                                                                                                           \nScanning linux images...                                                                                                                                                                                        \n\nRunning kernel seems to be up-to-date.\n\nNo services need to be restarted.\n\nNo containers need to be restarted.\n\nNo user sessions are running outdated binaries.\n\nNo VM guests are running outdated hypervisor (qemu) binaries on this host.\nrandark@elastic-server:~$ echo \"deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/9.x/apt stable main\" | sudo tee /etc/apt/sources.list.d/elastic-9.x.list\ndeb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/9.x/apt stable main\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5728\u6dfb\u52a0\u4e86 Elastic APT \u4ed3\u5e93\u4e4b\u540e"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"randark@elastic-server:~$ sudo apt-get update && sudo apt-get install elasticsearch\nHit:1 http://cn.archive.ubuntu.com/ubuntu noble InRelease\nHit:2 https://artifacts.elastic.co/packages/9.x/apt stable InRelease\nGet:3 http://cn.archive.ubuntu.com/ubuntu noble-updates InRelease [126 kB]\nHit:4 http://security.ubuntu.com/ubuntu noble-security InRelease\nHit:5 http://cn.archive.ubuntu.com/ubuntu noble-backports InRelease\nFetched 126 kB in 2s (81.8 kB/s)\nReading package lists... Done\nN: Missing Signed-By in the sources.list(5) entry for 'http://cn.archive.ubuntu.com/ubuntu'\nReading package lists... Done\nBuilding dependency tree... Done\nReading state information... Done\nThe following NEW packages will be installed:\n  elasticsearch\n0 upgraded, 1 newly installed, 0 to remove and 28 not upgraded.\nNeed to get 676 MB of archives.\nAfter this operation, 1,299 MB of additional disk space will be used.\nGet:1 https://artifacts.elastic.co/packages/9.x/apt stable/main amd64 elasticsearch amd64 9.1.5 [676 MB]\nFetched 660 MB in 42s (15.7 MB/s)                                                                                                                                                                              \nSelecting previously unselected package elasticsearch.\n(Reading database ... 87294 files and directories currently installed.)\nPreparing to unpack .../elasticsearch_9.1.5_amd64.deb ...\nCreating elasticsearch group... OK\nCreating elasticsearch user... OK\nUnpacking elasticsearch (9.1.5) ...\nSetting up elasticsearch (9.1.5) ...\n--------------------------- Security autoconfiguration information ------------------------------\n\nAuthentication and authorization are enabled.\nTLS for the transport and HTTP layers is enabled and configured.\n\nThe generated password for the elastic built-in superuser is : e5v39XvVWLyCUdOwGWSV\n\nIf this node should join an existing cluster, you can reconfigure this with\n'/usr/share/elasticsearch/bin/elasticsearch-reconfigure-node --enrollment-token <token-here>'\nafter creating an enrollment token on your existing cluster.\n\nYou can complete the following actions at any time:\n\nReset the password of the elastic built-in superuser with \n'/usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic'.\n\nGenerate an enrollment token for Kibana instances with \n '/usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana'.\n\nGenerate an enrollment token for Elasticsearch nodes with \n'/usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s node'.\n\n-------------------------------------------------------------------------------------------------\n### NOT starting on installation, please execute the following statements to configure elasticsearch service to start automatically using systemd\n sudo systemctl daemon-reload\n sudo systemctl enable elasticsearch.service\n### You can start elasticsearch service by executing\n sudo systemctl start elasticsearch.service\nScanning processes...                                                                                                                                                                                           \nScanning linux images...                                                                                                                                                                                        \n\nRunning kernel seems to be up-to-date.\n\nNo services need to be restarted.\n\nNo containers need to be restarted.\n\nNo user sessions are running outdated binaries.\n\nNo VM guests are running outdated hypervisor (qemu) binaries on this host.\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u914d\u7f6e-elasticsearch",children:"\u914d\u7f6e Elasticsearch"}),"\n",(0,a.jsxs)(n.p,{children:["\u7f16\u8f91 ",(0,a.jsx)(n.code,{children:"/etc/elasticsearch/elasticsearch.yml"})," \u6587\u4ef6\uff0c\u5728\u5176\u672b\u5c3e\u52a0\u4e0a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yml",children:"cluster.name: randark-elk\nnode.name: elk-1\nnetwork.host: 0.0.0.0\ndiscovery.type: single-node\n"})}),"\n",(0,a.jsxs)(n.admonition,{type:"note",children:[(0,a.jsxs)(n.p,{children:["\u4e0a\u8ff0 yml \u6587\u4ef6\u4e2d\uff0c\u53c2\u6570 ",(0,a.jsx)(n.code,{children:"cluster.name"})," \u548c ",(0,a.jsx)(n.code,{children:"node.name"})," \u53ef\u4ee5\u6309\u9700\u66f4\u6539"]}),(0,a.jsxs)(n.p,{children:["\u53c2\u6570 ",(0,a.jsx)(n.code,{children:"cluster.initial_master_nodes"})," \u9700\u8981\u88ab\u6ce8\u91ca\uff0c\u662f\u56e0\u4e3a\u9700\u8981\u7684\u662f\u5355\u673a\u90e8\u7f72"]}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yml",children:'cluster.initial_master_nodes: ["elastic-server"]\n'})})]}),"\n",(0,a.jsx)(n.h2,{id:"\u914d\u7f6e-elasticsearch-\u670d\u52a1",children:"\u914d\u7f6e Elasticsearch \u670d\u52a1"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"$ sudo systemctl daemon-reload\n$ sudo systemctl enable elasticsearch.service\nCreated symlink /etc/systemd/system/multi-user.target.wants/elasticsearch.service \u2192 /usr/lib/systemd/system/elasticsearch.service.\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u542f\u52a8\u670d\u52a1\u540e\uff0c\u67e5\u770b\u72b6\u6001"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"$ sudo systemctl start elasticsearch.service\n$ sudo systemctl status elasticsearch.service\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u7406\u8bba\u4e0a\u5e94\u5f53\u770b\u5230"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"randark@elastic-server:~$ sudo systemctl status elasticsearch.service\n\u25cf elasticsearch.service - Elasticsearch\n     Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled; preset: enabled)\n     Active: active (running) since Tue 2025-10-21 13:28:30 UTC; 11s ago\n       Docs: https://www.elastic.co\n   Main PID: 3668 (java)\n      Tasks: 80 (limit: 9379)\n     Memory: 4.3G (peak: 4.3G)\n        CPU: 1min 51.225s\n     CGroup: /system.slice/elasticsearch.service\n             \u251c\u25003668 /usr/share/elasticsearch/jdk/bin/java -Xms4m -Xmx64m -XX:+UseSerialGC -Dcli.name=server -Dcli.script=/usr/share/elasticsearch/bin/elasticsearch -Dcli.libs=lib/tools/server-cli -Des.path.h>\n             \u251c\u25003732 /usr/share/elasticsearch/jdk/bin/java -Des.networkaddress.cache.ttl=60 -Des.networkaddress.cache.negative.ttl=10 -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-8 >\n             \u2514\u25003755 /usr/share/elasticsearch/modules/x-pack-ml/platform/linux-x86_64/bin/controller\n\nOct 21 13:27:23 elastic-server systemd[1]: Starting elasticsearch.service - Elasticsearch...\nOct 21 13:28:30 elastic-server systemd[1]: Started elasticsearch.service - Elasticsearch.\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u5b89\u88c5-kibana-\u5e76\u914d\u7f6e",children:"\u5b89\u88c5 Kibana \u5e76\u914d\u7f6e"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"sudo apt install kibana\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u7136\u540e\u7f16\u8f91 ",(0,a.jsx)(n.code,{children:"/etc/kibana/kibana.yml"})," \u914d\u7f6e\u6587\u4ef6"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yml",children:"server.port: 5601\nserver.host: 0.0.0.0\nserver.name: randark-kibana\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u968f\u540e\u542f\u52a8\u670d\u52a1\uff0c\u5e94\u5f53\u80fd\u591f\u770b\u5230"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'randark@elastic-server:~$ sudo systemctl start kibana\nrandark@elastic-server:~$ sudo systemctl status kibana\n\u25cf kibana.service - Kibana\n     Loaded: loaded (/usr/lib/systemd/system/kibana.service; disabled; preset: enabled)\n     Active: active (running) since Tue 2025-10-21 13:58:01 UTC; 4s ago\n       Docs: https://www.elastic.co\n   Main PID: 5111 (node)\n      Tasks: 11 (limit: 9379)\n     Memory: 152.1M (peak: 152.4M)\n        CPU: 5.192s\n     CGroup: /system.slice/kibana.service\n             \u2514\u25005111 /usr/share/kibana/bin/../node/glibc-217/bin/node /usr/share/kibana/bin/../src/cli/dist\n\nOct 21 13:58:01 elastic-server systemd[1]: Started kibana.service - Kibana.\nOct 21 13:58:04 elastic-server kibana[5111]: {"log.level":"info","@timestamp":"2025-10-21T13:58:04.156Z","log.logger":"elastic-apm-node","ecs.version":"8.10.0","agentVersion":"4.13.0","env":{"pid":5111,"proc>\nOct 21 13:58:04 elastic-server kibana[5111]: Native global console methods have been overridden in production environment.\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u8fd9\u4e2a\u65f6\u5019\u8bbf\u95ee 5601 \u7aef\u53e3\uff0c\u5e94\u8be5\u80fd\u591f\u770b\u5230"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:s(8613).A+"",width:"2560",height:"1371"})}),"\n",(0,a.jsx)(n.h2,{id:"\u4e3a-kibana-\u751f\u6210\u52a0\u5bc6-key",children:"\u4e3a Kibana \u751f\u6210\u52a0\u5bc6 key"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"randark@elastic-server:~$ sudo /usr/share/kibana/bin/kibana-encryption-keys generate\n## Kibana Encryption Key Generation Utility\n\nThe 'generate' command guides you through the process of setting encryption keys for:\n\nxpack.encryptedSavedObjects.encryptionKey\n    Used to encrypt stored objects such as dashboards and visualizations\n    https://www.elastic.co/guide/en/kibana/current/xpack-security-secure-saved-objects.html#xpack-security-secure-saved-objects\n\nxpack.reporting.encryptionKey\n    Used to encrypt saved reports\n    https://www.elastic.co/guide/en/kibana/current/reporting-settings-kb.html#general-reporting-settings\n\nxpack.security.encryptionKey\n    Used to encrypt session information\n    https://www.elastic.co/guide/en/kibana/current/security-settings-kb.html#security-session-and-cookie-settings\n\n\nAlready defined settings are ignored and can be regenerated using the --force flag.  Check the documentation links for instructions on how to rotate encryption keys.\nDefinitions should be set in the kibana.yml used configure Kibana.\n\nSettings:\nxpack.encryptedSavedObjects.encryptionKey: a99322106d2964fbc48666f98562a6aa\nxpack.reporting.encryptionKey: f7b5d56daa013b43d42eef9c93cdfb7c\nxpack.security.encryptionKey: 5814a2f69914478b0260255564e18f49\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u968f\u540e\u7684\u914d\u7f6e\u5728 ",(0,a.jsx)(n.code,{children:"5601"})," webui \u4e2d\u8fdb\u884c\u914d\u7f6e"]}),"\n",(0,a.jsx)(n.h2,{id:"reference",children:"Reference"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"https://blog.csdn.net/UbuntuTouch/article/details/114023944",children:"Security\uff1a\u5982\u4f55\u5b89\u88c5 Elastic SIEM \u548c EDR_elastic edr-CSDN\u535a\u5ba2"})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);