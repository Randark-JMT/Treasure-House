"use strict";(self.webpackChunktreasure_house=self.webpackChunktreasure_house||[]).push([[7964],{3823:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"CheatSheet/Windows_post-exploitation","title":"Windows \u540e\u6e17\u900f","description":"\u6587\u4ef6\u6316\u6398\u56de\u4f20","source":"@site/docs/CheatSheet/Windows_post-exploitation.md","sourceDirName":"CheatSheet","slug":"/CheatSheet/Windows_post-exploitation","permalink":"/docs/CheatSheet/Windows_post-exploitation","draft":false,"unlisted":false,"editUrl":"https://github.com/Randark-JMT/Treasure-House/edit/main/docs/CheatSheet/Windows_post-exploitation.md","tags":[],"version":"current","frontMatter":{},"sidebar":"CheatSheet_Sidebar"}');var a=t(4848),o=t(8453);const r={},i="Windows \u540e\u6e17\u900f",l={},h=[{value:"\u6587\u4ef6\u6316\u6398\u56de\u4f20",id:"\u6587\u4ef6\u6316\u6398\u56de\u4f20",level:2},{value:"Internet Information Services (IIS)",id:"internet-information-services-iis",level:2},{value:"\u5217\u51fa\u7f51\u7ad9\u76ee\u5f55",id:"\u5217\u51fa\u7f51\u7ad9\u76ee\u5f55",level:3},{value:"Microsoft Defender",id:"microsoft-defender",level:2},{value:"\u67e5\u8be2\u6392\u9664\u9879",id:"\u67e5\u8be2\u6392\u9664\u9879",level:3},{value:"Vmware Workstation",id:"vmware-workstation",level:2},{value:"\u5de5\u5177\u53c2\u8003",id:"\u5de5\u5177\u53c2\u8003",level:2},{value:"vmrun",id:"vmrun",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"windows-\u540e\u6e17\u900f",children:"Windows \u540e\u6e17\u900f"})}),"\n",(0,a.jsx)(n.h2,{id:"\u6587\u4ef6\u6316\u6398\u56de\u4f20",children:"\u6587\u4ef6\u6316\u6398\u56de\u4f20"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:'Get-ChildItem -Path E:\\ -Filter Web.Config -Recurse -ErrorAction SilentlyContinue | Select-Object -ExpandProperty FullName\n\nCompress-Archive -Path (Get-ChildItem -Path "E:\\" -Filter "Web.Config" -Recurse -ErrorAction SilentlyContinue).FullName -DestinationPath "C:\\Windows\\Temp\\webconfigs.zip"\n\nGet-ChildItem -Path "E:\\" -Filter "web.config" -Recurse -ErrorAction SilentlyContinue | ForEach-Object { $_.FullName.Substring(3) } | Set-Content "C:\\Windows\\Temp\\webconfigs.txt" -Encoding utf8\n# \u5207\u6362\u4e3a cmd\nC:\\Windows\\Temp\\7zr.exe a -t7z "C:\\Windows\\Temp\\webconfigs.7z" -scsUTF-8 @"C:\\Windows\\Temp\\webconfigs.txt"\n'})}),"\n",(0,a.jsx)(n.h2,{id:"internet-information-services-iis",children:"Internet Information Services (IIS)"}),"\n",(0,a.jsx)(n.h3,{id:"\u5217\u51fa\u7f51\u7ad9\u76ee\u5f55",children:"\u5217\u51fa\u7f51\u7ad9\u76ee\u5f55"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"c:\\windows\\system32\\inetsrv\\appcmd list vdir\n"})}),"\n",(0,a.jsx)(n.h2,{id:"microsoft-defender",children:"Microsoft Defender"}),"\n",(0,a.jsx)(n.h3,{id:"\u67e5\u8be2\u6392\u9664\u9879",children:"\u67e5\u8be2\u6392\u9664\u9879"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"Get-MpPreference | Select-Object -Property ExclusionPath, ExclusionProcess, ExclusionExtension\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u6dfb\u52a0\u6392\u9664\u9879"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:'Add-MpPreference -ExclusionPath "D:\\MySafeFolder"\nAdd-MpPreference -ExclusionPath "C:\\Windows\\Temp"\nAdd-MpPreference -ExclusionPath "C:\\Windows\\System32"\nAdd-MpPreference -ExclusionPath "C:\\Users\\Public\\Libraries"\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u53d6\u6d88\u6392\u9664\u9879"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:'Remove-MpPreference -ExclusionPath "C:\\Windows\\Temp"\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u67e5\u8be2\u60c5\u62a5"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"Get-MpThreatDetection\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5220\u9664\u60c5\u62a5"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'"C:\\Program Files\\Windows Defender\\MpCmdRun.exe" -RemoveDynamicSignature\n\n# Powershell\nRemove-Item "C:\\ProgramData\\Microsoft\\Windows Defender\\Scans\\History\\Service\\*" -Recurse -Force\n'})}),"\n",(0,a.jsx)(n.h2,{id:"vmware-workstation",children:"Vmware Workstation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'"C:\\Program Files (x86)\\VMware\\VMware Player\\vmrun.exe"\n"C:\\Program Files (x86)\\VMware\\VMware Workstation\\vmrun.exe"\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u6536\u96c6\u6240\u6709\u5728\u8fd0\u884c\u7684\u865a\u62df\u673a"}),"\n",(0,a.jsx)(n.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u8fd0\u884c\u547d\u4ee4\u8fdb\u884c\u67e5\u8be2\u7684\u6743\u9650\u9700\u8981\u4e0e\u8fd0\u884c\u865a\u62df\u673a\u7684\u7528\u6237\u6743\u9650\u4e00\u81f4\uff0c\u8fc7\u9ad8\u6216\u8005\u8fc7\u4f4e\u90fd\u4f1a\u5bfc\u81f4\u67e5\u8be2\u4e0d\u5230\u865a\u62df\u673a"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'"C:\\Program Files (x86)\\VMware\\VMware Workstation\\vmrun.exe" list\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u6536\u96c6\u6240\u6709\u7684\u865a\u62df\u673a\u7f51\u5361"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'"C:\\Program Files (x86)\\VMware\\VMware Workstation\\vmrun.exe" listHostNetworks\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u83b7\u53d6\u865a\u62df\u673a\u7f51\u5361\u5730\u5740"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'"C:\\Program Files (x86)\\VMware\\VMware Workstation\\vmrun.exe" -T ws getGuestIPAddress "E:\\WIN11E TS - TPE NEW GRM 09\\WIN11E TS - TPE.vmx" -wait\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u5236\u4f5c\u5feb\u7167"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'"C:\\Program Files (x86)\\VMware\\VMware Player\\vmrun.exe" -T ws snapshot "C:\\VM\\WinServer_2012R2\\Windows Server 2012.vmx" 2025-07-11\n'})}),"\n",(0,a.jsx)(n.h2,{id:"\u5de5\u5177\u53c2\u8003",children:"\u5de5\u5177\u53c2\u8003"}),"\n",(0,a.jsx)(n.h3,{id:"vmrun",children:"vmrun"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'vmrun version 1.17.0 build-20800274\n\nUsage: vmrun [AUTHENTICATION-FLAGS] COMMAND [PARAMETERS]\n\n\n\nAUTHENTICATION-FLAGS\n--------------------\nThese must appear before the command and any command parameters.\n\n   -T <hostType> (ws|fusion||player)\n   -vp <password for encrypted virtual machine>\n   -gu <userName in guest OS>\n   -gp <password in guest OS>\n\n\n\nPOWER COMMANDS           PARAMETERS           DESCRIPTION\n--------------           ----------           -----------\nstart                    Path to vmx file     Start a VM or Team\n                         [gui|nogui]\n\nstop                     Path to vmx file     Stop a VM or Team\n                         [hard|soft]\n\nreset                    Path to vmx file     Reset a VM or Team\n                         [hard|soft]\n\nsuspend                  Path to vmx file     Suspend a VM or Team\n                         [hard|soft]\n\npause                    Path to vmx file     Pause a VM\n\nunpause                  Path to vmx file     Unpause a VM\n\n\n\nSNAPSHOT COMMANDS        PARAMETERS           DESCRIPTION\n-----------------        ----------           -----------\nlistSnapshots            Path to vmx file     List all snapshots in a VM\n                         [showTree]\n\nsnapshot                 Path to vmx file     Create a snapshot of a VM\n                         Snapshot name\n\ndeleteSnapshot           Path to vmx file     Remove a snapshot from a VM\n                         Snapshot name\n                         [andDeleteChildren]\n\nrevertToSnapshot         Path to vmx file     Set VM state to a snapshot\n                         Snapshot name\n\n\n\nHOST NETWORK COMMANDS    PARAMETERS           DESCRIPTION\n---------------------    ----------           -----------\nlistHostNetworks                              List all networks in the host\n\nlistPortForwardings      Host network name    List all available port forwardings on a host network\n\n\nsetPortForwarding        Host network name    Add or update a port forwarding on a host network\n                         Protocol\n                         Host port\n                         Guest ip\n                         Guest port\n                         [Description]\n\ndeletePortForwarding     Host network name    Delete a port forwarding on a host network\n                         Protocol\n                         Host port\n\n\n\n\nGUEST OS COMMANDS        PARAMETERS           DESCRIPTION\n-----------------        ----------           -----------\nrunProgramInGuest        Path to vmx file     Run a program in Guest OS\n                         [-noWait]\n                         [-activeWindow]\n                         [-interactive]\n                         Complete-Path-To-Program\n                         [Program arguments]\n\nfileExistsInGuest        Path to vmx file     Check if a file exists in Guest OS\n                         Path to file in guest\n\ndirectoryExistsInGuest   Path to vmx file     Check if a directory exists in Guest OS\n                         Path to directory in guest\n\nsetSharedFolderState     Path to vmx file     Modify a Host-Guest shared folder\n                         Share name\n                         Host path\n                         writable | readonly\n\naddSharedFolder          Path to vmx file     Add a Host-Guest shared folder\n                         Share name\n                         New host path\n\nremoveSharedFolder       Path to vmx file     Remove a Host-Guest shared folder\n                         Share name\n\nenableSharedFolders      Path to vmx file     Enable shared folders in Guest\n                         [runtime]\n\ndisableSharedFolders     Path to vmx file     Disable shared folders in Guest\n                         [runtime]\n\nlistProcessesInGuest     Path to vmx file     List running processes in Guest OS\n\nkillProcessInGuest       Path to vmx file     Kill a process in Guest OS\n                         process id\n\nrunScriptInGuest         Path to vmx file     Run a script in Guest OS\n                         [-noWait]\n                         [-activeWindow]\n                         [-interactive]\n                         Interpreter path\n                         Script text\n\ndeleteFileInGuest        Path to vmx file     Delete a file in Guest OS\n                         Path in guest\n\ncreateDirectoryInGuest   Path to vmx file     Create a directory in Guest OS\n                         Directory path in guest\n\ndeleteDirectoryInGuest   Path to vmx file     Delete a directory in Guest OS\n                         Directory path in guest\n\nCreateTempfileInGuest    Path to vmx file     Create a temporary file in Guest OS\n\nlistDirectoryInGuest     Path to vmx file     List a directory in Guest OS\n                         Directory path in guest\n\nCopyFileFromHostToGuest  Path to vmx file     Copy a file from host OS to guest OS\n                         Path on host\n                         Path in guest\n\nCopyFileFromGuestToHost  Path to vmx file     Copy a file from guest OS to host OS\n                         Path in guest\n                         Path on host\n\nrenameFileInGuest        Path to vmx file     Rename a file in Guest OS\n                         Original name\n                         New name\n\ntypeKeystrokesInGuest    Path to vmx file     Type Keystrokes in Guest OS\n                         keystroke string\n\nconnectNamedDevice       Path to vmx file     Connect the named device in the Guest OS\n                         device name\n\ndisconnectNamedDevice    Path to vmx file     Disconnect the named device in the Guest OS\n                         device name\n\ncaptureScreen            Path to vmx file     Capture the screen of the VM to a local file\n                         Path on host\n\nwriteVariable            Path to vmx file     Write a variable in the VM state\n                         [runtimeConfig|guestEnv|guestVar]\n                         variable name\n                         variable value\n\nreadVariable             Path to vmx file     Read a variable in the VM state\n                         [runtimeConfig|guestEnv|guestVar]\n                         variable name\n\ngetGuestIPAddress        Path to vmx file     Gets the IP address of the guest\n                         [-wait]\n\n\n\nGENERAL COMMANDS         PARAMETERS           DESCRIPTION\n----------------         ----------           -----------\nlist                                          List all running VMs\n\nupgradevm                Path to vmx file     Upgrade VM file format, virtual hw\n\ninstallTools             Path to vmx file     Install Tools in Guest\n\ncheckToolsState          Path to vmx file     Check the current Tools state\n\ndeleteVM                 Path to vmx file     Delete a VM\n\nclone                    Path to vmx file     Create a copy of the VM\n                         Path to destination vmx file\n                         full|linked\n                         [-snapshot=Snapshot Name]\n                         [-cloneName=Name]\n\n\n\nTemplate VM COMMANDS     PARAMETERS           DESCRIPTION\n---------------------    ----------           -----------\ndownloadPhotonVM         Path for new VM      Download Photon VM\n\n\n\n\n\nExamples:\n\n\nStarting a virtual machine with Workstation on a Windows host\n   vmrun -T ws start "c:\\my VMs\\myVM.vmx"\n\n\nRunning a program in a virtual machine with Workstation on a Windows host with Windows guest\n   vmrun -T ws -gu guestUser -gp guestPassword runProgramInGuest "c:\\my VMs\\myVM.vmx" "c:\\Program Files\\myProgram.exe"\n\n\nCreating a snapshot of a virtual machine with Workstation on a Windows host\n   vmrun -T ws snapshot "c:\\my VMs\\myVM.vmx" mySnapshot\n\n\nReverting to a snapshot with Workstation on a Windows host\n   vmrun -T ws revertToSnapshot "c:\\my VMs\\myVM.vmx" mySnapshot\n\n\nDeleting a snapshot with Workstation on a Windows host\n   vmrun -T ws deleteSnapshot "c:\\my VMs\\myVM.vmx" mySnapshot\n\n\nEnabling Shared Folders with Workstation on a Windows host\n   vmrun -T ws enableSharedFolders "c:\\my VMs\\myVM.vmx"\n'})})]})}function c(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>i});var s=t(6540);const a={},o=s.createContext(a);function r(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);