"use strict";(self.webpackChunktreasure_house=self.webpackChunktreasure_house||[]).push([[1477],{10:n=>{n.exports=JSON.parse('{"blogPosts":[{"id":"2023-10-26-0xGame2023-oh-my-linux","metadata":{"permalink":"/blog/2023-10-26-0xGame2023-oh-my-linux","editUrl":"https://github.com/Randark-JMT/Treasure-House/edit/main/blog/2023-10-26-0xGame2023-oh-my-linux/index.md","source":"@site/blog/2023-10-26-0xGame2023-oh-my-linux/index.md","title":"0xGame2023 oh-my-linux \u6280\u672f\u5206\u6790","description":"\u9996\u5148\uff0c\u5148\u5206\u6790\u955c\u50cf\u7684\u5185\u6838\u4fe1\u606f\uff1a","date":"2023-10-26T00:00:00.000Z","formattedDate":"2023\u5e7410\u670826\u65e5","tags":[{"label":"Memory-Forensic","permalink":"/blog/tags/memory-forensic"}],"readingTime":3.17,"hasTruncateMarker":false,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://randark.site/img/logo.jpg","key":"Randark"}],"frontMatter":{"slug":"2023-10-26-0xGame2023-oh-my-linux","title":"0xGame2023 oh-my-linux \u6280\u672f\u5206\u6790","authors":"Randark","tags":["Memory-Forensic"]},"unlisted":false,"nextItem":{"title":"\u5185\u5b58\u53d6\u8bc1\u5b9e\u9a8c - \u955c\u50cf + \u914d\u7f6e\u6587\u4ef6","permalink":"/blog/2023-10-25-MemoryForensic-Test"}},"content":"\u9996\u5148\uff0c\u5148\u5206\u6790\u955c\u50cf\u7684\u5185\u6838\u4fe1\u606f\uff1a\\n\\n```shell\\nrandark@memory-forensic:~$ vol -f oh-my-linux.mem banner\\nVolatility 3 Framework 2.0.1\\nProgress:  100.00               PDB scanning finished\\nOffset  Banner\\n\\n0x4f000200      Linux version 5.10.0-21-amd64 (debian-kernel@lists.debian.org) (gcc-10 (Debian 10.2.1-6) 10.2.1 20210110, GNU ld (GNU Binutils for Debian) 2.35.2) #1 SMP Debian 5.10.162-1 (2023-01-21)\\n0x58ecc240      Linux version 5.10.0-21-amd64 (debian-kernel@lists.debian.org) (gcc-10 (Debian 10.2.1-6) 10.2.1 20210110, GNU ld (GNU Binutils for Debian) 2.35.2) #1 SMP Debian 5.10.162-1 (2023-01-21)\\n```\\n\\n\u901a\u8fc7\u5185\u6838\u4fe1\u606f\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230 `Debian 5.10.0-21-amd64` \u7684 deb \u53d1\u884c\u5305\u6587\u4ef6\uff1a\\n\\n[Index of /debian-security/pool/main/l/linux](https://debian.sipwise.com/debian-security/pool/main/l/linux/)\\n\\n![linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.deb](img/image_20231022-192239.png)\\n\\n\u4e0b\u8f7d\u4e0b\u6765\u540e\uff0c\u5c06\u5176\u4f5c\u4e3a `tar.xz` \u6587\u4ef6\u8fdb\u884c\u89e3\u538b\u7f29\uff0c\u5f97\u5230 `data.tar` \u6587\u4ef6\uff0c\u89e3\u538b\u7f29\u5236\u4f5c\u7b26\u53f7\u8868\u9700\u8981\u7684\u6587\u4ef6\uff1a\\n\\n```shell\\nrandark@memory-forensic:~/linux-image$ tar -xvf data.tar ./usr/lib/debug/boot/\\n./usr/lib/debug/boot/\\n./usr/lib/debug/boot/System.map-5.10.0-21-amd64\\n./usr/lib/debug/boot/vmlinux-5.10.0-21-amd64\\n```\\n\\n\u7136\u540e\u5f00\u59cb\u5236\u4f5c\u7b26\u53f7\u8868\u6587\u4ef6\\n\\n```shell\\nrandark@memory-forensic:~$  ./dwarf2json linux --system-map ~/linux-image/usr/lib/debug/boot/System.map-5.10.0-21-amd64 --elf ~/linux-image/usr/lib/debug/boot/vmlinux-5.10.0-21-amd64  >  linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.json\\nrandark@memory-forensic:~$ sudo mv linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.json /usr/local/lib/python3.10/dist-packages/volatility3/symbols/linux/\\n```\\n\\n\u5c1d\u8bd5\u4f7f\u7528\u7b26\u53f7\u8868\u8fdb\u884c\u5206\u6790\uff1a\\n\\n```shell\\nrandark@memory-forensic:~$ vol -f oh-my-linux.mem linux.pslist\\nVolatility 3 Framework 2.0.1\\nProgress:  100.00               Stacking attempts finished\\nPID     PPID    COMM\\n\\n1       0       systemd\\n2       0       kthreadd\\n3       2       rcu_gp\\n4       2       rcu_par_gp\\n6       2       kworker/0:0H\\n8       2       mm_percpu_wq\\n9       2       rcu_tasks_rude_\\n10      2       rcu_tasks_trace\\n11      2       ksoftirqd/0\\n12      2       rcu_sched\\n13      2       migration/0\\n14      2       kworker/0:1\\n15      2       cpuhp/0\\n17      2       kdevtmpfs\\n18      2       netns\\n19      2       kauditd\\n20      2       khungtaskd\\n21      2       oom_reaper\\n22      2       writeback\\n23      2       kcompactd0\\n24      2       ksmd\\n25      2       khugepaged\\n43      2       kintegrityd\\n44      2       kblockd\\n45      2       blkcg_punt_bio\\n46      2       edac-poller\\n47      2       devfreq_wq\\n48      2       kworker/0:1H\\n49      2       kswapd0\\n50      2       kthrotld\\n......\\n```\\n\\n\u6210\u529f\u5b9e\u73b0 Volatility3 \u52a0\u8f7d\u7b26\u53f7\u8868\uff0c\u5e76\u5206\u6790\u955c\u50cf\\n\\n\u5982\u679c\u8981\u4f7f\u7528 Volatility2 \u8fdb\u884c\u5206\u6790\u7684\u8bdd\uff0c\u9700\u8981\u4f7f\u7528 linux-header,linux-image \u7b49\u76f8\u5173\u8f6f\u4ef6\u5305\u8fdb\u884c\u7f16\u8bd1\uff0c\u4e3a\u4e86\u4e0d\u5f71\u54cd\u4e3b\u673a\u73af\u5883\uff0c\u4ee5\u53ca\u61d2\u5f97\u5f00\u865a\u62df\u673a\u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528 docker \u8fdb\u884c\u7f16\u8bd1\uff1a\\n\\n[CTF-Archives / profile-builder](https://github.com/CTF-Archives/profile-builder)\\n\\n\u7f16\u8bd1\u540e\uff0c\u5e94\u8be5\u4f1a\u5728 `./docker/data` \u76ee\u5f55\u4e0b\u5f97\u5230\u7f16\u8bd1\u597d\u7684 dwarf \u6587\u4ef6\uff0c\u5373\u53ef\u5f00\u59cb\u7ec4\u88c5\u9002\u7528\u4e8e Volatility2 \u7684\u914d\u7f6e\u6587\u4ef6\\n\\n```shell\\n# \u8fd9\u91cc\u7528\u7684 System.map \u6587\u4ef6\uff0c\u4e3a\u4e0a\u9762\u62c6 deb \u5305\u5f97\u5230\u7684\\nrandark@memory-forensic:~$ zip Debian_5.10.0-21-amd64_profile.zip module.dwarf ~/linux-image/usr/lib/debug/boot/System.map-5.10.0-21-amd64\\nrandark@memory-forensic:~$ mv Debian_5.10.0-21-amd64_profile.zip ./volatility2/volatility/plugins/overlays/linux/\\nrandark@memory-forensic:~$ python2 ./volatility2/vol.py --info | grep Profile | grep Linux\\nVolatility Foundation Volatility Framework 2.6.1\\nLinuxDebian_5_10_0-21-amd64_profilex64  - A Profile for Linux Debian_5.10.0-21-amd64_profile x64\\nLinuxUbuntu_6_2_0-35-generic_profilex64 - A Profile for Linux Ubuntu_6.2.0-35-generic_profile x64\\n```\\n\\n\u6210\u529f\u5236\u4f5c\u5e76\u5728 Volatility2 \u4e2d\u52a0\u8f7d\u4e86\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u5de5\u4f5c\u6b63\u5e38\\n\\n```shell\\nrandark@memory-forensic:~$ python2 ./volatility2/vol.py -f oh-my-linux.mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_bash\\nVolatility Foundation Volatility Framework 2.6.1\\nWARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes\\nWARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes\\nPid      Name                 Command Time                   Command\\n-------- -------------------- ------------------------------ -------\\n    1014 bash                 2023-02-25 15:45:08 UTC+0000   echo $SHELL\\n    1014 bash                 2023-02-25 15:45:23 UTC+0000   echo \\"Bash doesn\'t feel as good as zsh\\"\\n    1014 bash                 2023-02-25 15:45:27 UTC+0000   echo \\"lol\\"\\n    1014 bash                 2023-02-25 15:45:29 UTC+0000   zsh\\n```\\n\\n\u8bfb\u53d6 zsh \u7684\u5386\u53f2\u8bb0\u5f55\uff0c\u5c31\u80fd\u77e5\u9053\u600e\u4e48\u89e3\u9898\u4e86\\n\\n```shell\\nrandark@memory-forensic:~$ cat a1\\n: 1677339944:0;echo $SHELL\\n: 1677339951:0;sudo apt install curl\\n: 1677340139:0;sh -c \\"$(curl -fsSL https://gitee.com/mirrors/oh-my-zsh/raw/master/tools/install.sh)\\"\\n: 1677340199:0;echo $SHELL\\n: 1677340205:0;echo \\"nice\\"\\n: 1677340215:0;mv mysecretflag1.zsh-theme ~/.oh-my-zsh/themes\\n: 1677340217:0;ls\\n: 1677340222:0;vim ~/.zshrc\\n: 1677340268:0;source ~/.zshrc\\n: 1677340271:0;ls\\n: 1677340299:0;zip -o flag2.zip flag2.txt -P $SHELL\\n: 1677340311:0;rm -rf flag2.txt\\n: 1677340315:0;ls\\n: 1677340324:0;G1v3m3F14ggg3\\n: 1677340335:0;echo \\"lol\\"\\n: 1677340354:0;sudo ./avml oh-my-linux.mem\\n```"},{"id":"2023-10-25-MemoryForensic-Test","metadata":{"permalink":"/blog/2023-10-25-MemoryForensic-Test","editUrl":"https://github.com/Randark-JMT/Treasure-House/edit/main/blog/2023-10-25-MemoryForensic-Test/index.md","source":"@site/blog/2023-10-25-MemoryForensic-Test/index.md","title":"\u5185\u5b58\u53d6\u8bc1\u5b9e\u9a8c - \u955c\u50cf + \u914d\u7f6e\u6587\u4ef6","description":"\u65b0\u5efa\u865a\u62df\u673a\uff0c\u4f7f\u7528 ubuntu-22.04.2-desktop-amd64.iso \u4f5c\u4e3a\u5b89\u88c5\u955c\u50cf\uff0c\u6b63\u5e38\u5b8c\u6210\u5b89\u88c5\uff0c\u9009\u62e9\u6700\u5c0f\u5316\u5b89\u88c5\uff0c\u5e76\u4e14\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u4e0d\u8fdb\u884c\u81ea\u52a8\u66f4\u65b0","date":"2023-10-25T00:00:00.000Z","formattedDate":"2023\u5e7410\u670825\u65e5","tags":[{"label":"Memory-Forensic","permalink":"/blog/tags/memory-forensic"}],"readingTime":8.68,"hasTruncateMarker":false,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://randark.site/img/logo.jpg","key":"Randark"}],"frontMatter":{"slug":"2023-10-25-MemoryForensic-Test","title":"\u5185\u5b58\u53d6\u8bc1\u5b9e\u9a8c - \u955c\u50cf + \u914d\u7f6e\u6587\u4ef6","authors":"Randark","tags":["Memory-Forensic"]},"unlisted":false,"prevItem":{"title":"0xGame2023 oh-my-linux \u6280\u672f\u5206\u6790","permalink":"/blog/2023-10-26-0xGame2023-oh-my-linux"}},"content":"\u65b0\u5efa\u865a\u62df\u673a\uff0c\u4f7f\u7528 `ubuntu-22.04.2-desktop-amd64.iso` \u4f5c\u4e3a\u5b89\u88c5\u955c\u50cf\uff0c\u6b63\u5e38\u5b8c\u6210\u5b89\u88c5\uff0c\u9009\u62e9\u6700\u5c0f\u5316\u5b89\u88c5\uff0c\u5e76\u4e14\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u4e0d\u8fdb\u884c\u81ea\u52a8\u66f4\u65b0\\n\\n![Ubuntu install option](img/image_20231037-233754.png)\\n\\n\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u4e3a\u7eaf\u51c0\u72b6\u6001\u5236\u4f5c\u5feb\u7167\\n\\n![Vmware Create Init Capture](img/image_20231046-234659.png)\\n\\n\u7136\u540e\u5b89\u88c5\u5fc5\u8981\u7684\u8f6f\u4ef6\u5305\uff1a\\n\\n- openssh-server\\n- make\\n- gcc\\n- net-tools\\n\\n```shell\\nrandark@randark-test:~$ sudo mv /etc/apt/sources.list /etc/apt/sources.list.bak\\nrandark@randark-test:~$ sudo nano /etc/apt/sources.list\\n# \u5c06 apt \u7684\u6e90\u4ed3\u5e93\u5730\u5740\u6362\u4e3a ustc \u4e2d\u79d1\u5927\u6e90\\nrandark@randark-test:~$ sudo apt update\\n......\\nrandark@randark-test:~$ sudo apt install openssh-server gcc make net-tools\\n......\\nrandark@randark-test:~$ sudo systemctl enable ssh\\nSynchronizing state of ssh.service with SysV service script with /lib/systemd/systemd-sysv-install.\\nExecuting: /lib/systemd/systemd-sysv-install enable ssh\\nrandark@randark-test:~$ sudo systemctl start ssh\\n```\\n\\n\u7136\u540e\uff0c\u901a\u8fc7 ssh \u4e0e sftp \u8fdb\u884c\u64cd\u4f5c\uff1a\u9996\u5148\uff0c\u5c06 [AVML](https://github.com/microsoft/avml) \u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4f20\u8f93\u5230\u6d4b\u8bd5\u673a\u4e0a\uff0c\u5e76\u6388\u4e88\u6267\u884c\u6743\u9650\uff0c\u7136\u540e\u5f00\u59cb\u5236\u4f5c\u955c\u50cf\\n\\n```shell\\nrandark@randark-test:~$ chmod +x avml\\nrandark@randark-test:~$ sudo ./avml out.lime\\nrandark@randark-test:~$ ls -lh\\ntotal 4.1G\\n-rwxrwxr-x 1 randark randark 6.4M 10 \u6708 26 00:01 avml\\n-rw------- 1 root    root    4.0G 10 \u6708 26 00:02 out.lime\\ndrwx------ 3 randark randark 4.0K 10 \u6708 25 23:52 snap\\n```\\n\\n\u6210\u529f\u5f97\u5230 `out.lime` \u5185\u5b58\u955c\u50cf\u6587\u4ef6\\n\\n\u63a5\u4e0b\u6765\uff0c\u5f00\u59cb\u6784\u5efa `dwarf` \u5185\u6838\u8c03\u8bd5\u6587\u4ef6\uff0c\u4e0e\u83b7\u53d6 `System.map` \u5185\u5b58\u8868\u6587\u4ef6\\n\\n\u9996\u5148\uff0c\u786e\u5b9a Linux Kernel \u7684\u7248\u672c\\n\\n```shell\\nrandark@randark-test:~$ uname -a\\nLinux randark-test 6.2.0-35-generic #35~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Oct  6 10:23:26 UTC 2 x86_64 x86_64 x86_64 GNU/Linux\\n```\\n\\n\u7136\u540e\u4f20\u8f93 dwarf \u5185\u6838\u8c03\u8bd5\u6587\u4ef6\u7684\u7f16\u8bd1\u6587\u4ef6\uff1a[volatility/tools/linux](https://github.com/volatilityfoundation/volatility/tree/master/tools/linux)\uff0c\u5e76\u5c1d\u8bd5\u8fdb\u884c\u7f16\u8bd1\\n\\n```shell\\nrandark@randark-test:~/linux$ ls -lh\\ntotal 32K\\ndrwxrwxr-x 2 randark randark 4.0K 10 \u6708 24 23:54 kcore\\n-rw-rw-r-- 1 randark randark  384 10 \u6708 24 23:54 Makefile\\n-rw-rw-r-- 1 randark randark  314 10 \u6708 24 23:54 Makefile.enterprise\\n-rw-rw-r-- 1 randark randark  18K 10 \u6708 24 23:54 module.c\\nrandark@randark-test:~/linux$ make\\nmake -C //lib/modules/6.2.0-35-generic/build CONFIG_DEBUG_INFO=y M=\\"/home/randark/linux\\" modules\\nmake[1]: Entering directory \'/usr/src/linux-headers-6.2.0-35-generic\'\\nwarning: the compiler differs from the one used to build the kernel\\n  The kernel was built by: x86_64-linux-gnu-gcc-11 (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0\\n  You are using:           gcc-11 (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0\\n  CC [M]  /home/randark/linux/module.o\\n/home/randark/linux/module.c:136: warning: \\"__rcu\\" redefined\\n  136 | #define __rcu\\n      |\\nIn file included from <command-line>:\\n././include/linux/compiler_types.h:52: note: this is the location of the previous definition\\n   52 | # define __rcu          BTF_TYPE_TAG(rcu)\\n      |\\n  MODPOST /home/randark/linux/Module.symvers\\nERROR: modpost: missing MODULE_LICENSE() in /home/randark/linux/module.o\\nmake[2]: *** [scripts/Makefile.modpost:138: /home/randark/linux/Module.symvers] Error 1\\nmake[1]: *** [Makefile:1978: modpost] Error 2\\nmake[1]: Leaving directory \'/usr/src/linux-headers-6.2.0-35-generic\'\\nmake: *** [Makefile:10: dwarf] Error 2\\n```\\n\\n\u53ef\u4ee5\u53d1\u73b0\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u5b58\u5728\u81f4\u547d\u9519\u8bef\uff1a`modpost: missing MODULE_LICENSE() in /home/randark/linux/module.o`\\n\\n\u5728 `module.c` \u7684\u6587\u4ef6\u672b\u5c3e\u52a0\u4e0a\u4ee5\u4e0b\u8bed\u53e5\uff1a\\n\\n```c\\nMODULE_LICENSE(\\"GPL\\");\\n```\\n\\n\u6216\u8005\u6267\u884c\uff1a\\n\\n```shell\\necho \'MODULE_LICENSE(\\"GPL\\");\' >> module.c\\n```\\n\\n\u7ee7\u7eed\u5c1d\u8bd5\u7f16\u8bd1\uff1a\\n\\n```shell\\nrandark@randark-test:~/linux$ make\\nmake -C //lib/modules/6.2.0-35-generic/build CONFIG_DEBUG_INFO=y M=\\"/home/randark/linux\\" modules\\nmake[1]: Entering directory \'/usr/src/linux-headers-6.2.0-35-generic\'\\nwarning: the compiler differs from the one used to build the kernel\\n  The kernel was built by: x86_64-linux-gnu-gcc-11 (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0\\n  You are using:           gcc-11 (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0\\n  CC [M]  /home/randark/linux/module.o\\n/home/randark/linux/module.c:136: warning: \\"__rcu\\" redefined\\n  136 | #define __rcu\\n      |\\nIn file included from <command-line>:\\n././include/linux/compiler_types.h:52: note: this is the location of the previous definition\\n   52 | # define __rcu          BTF_TYPE_TAG(rcu)\\n      |\\n  MODPOST /home/randark/linux/Module.symvers\\n  CC [M]  /home/randark/linux/module.mod.o\\n  LD [M]  /home/randark/linux/module.ko\\n  BTF [M] /home/randark/linux/module.ko\\nSkipping BTF generation for /home/randark/linux/module.ko due to unavailability of vmlinux\\nmake[1]: Leaving directory \'/usr/src/linux-headers-6.2.0-35-generic\'\\ndwarfdump -di module.ko > module.dwarf\\n/bin/sh: 1: dwarfdump: not found\\n```\\n\\n\u7ee7\u7eed\u53d1\u73b0\u5b58\u5728\u81f4\u547d\u9519\u8bef\uff1a`/bin/sh: 1: dwarfdump: not found`\\n\\n\u67e5\u9605\u76f8\u5173\u6587\u6863 [Creating a new profile](https://github.com/volatilityfoundation/volatility/wiki/Linux#creating-a-new-profile) \u540e\uff0c\u5f97\u77e5\u9700\u8981\u5b89\u88c5\u4ee5\u4e0b\u5de5\u5177\uff1a\\n\\n- dwarfdump\\n\\n\u7ee7\u7eed\u5c1d\u8bd5\u7f16\u8bd1\uff1a\\n\\n```shell\\nrandark@randark-test:~/linux$ make\\nmake -C //lib/modules/6.2.0-35-generic/build CONFIG_DEBUG_INFO=y M=\\"/home/randark/linux\\" modules\\nmake[1]: Entering directory \'/usr/src/linux-headers-6.2.0-35-generic\'\\nwarning: the compiler differs from the one used to build the kernel\\n  The kernel was built by: x86_64-linux-gnu-gcc-11 (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0\\n  You are using:           gcc-11 (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0\\n  CC [M]  /home/randark/linux/module.o\\n/home/randark/linux/module.c:136: warning: \\"__rcu\\" redefined\\n  136 | #define __rcu\\n      |\\nIn file included from <command-line>:\\n././include/linux/compiler_types.h:52: note: this is the location of the previous definition\\n   52 | # define __rcu          BTF_TYPE_TAG(rcu)\\n      |\\n  MODPOST /home/randark/linux/Module.symvers\\n  CC [M]  /home/randark/linux/module.mod.o\\n  LD [M]  /home/randark/linux/module.ko\\n  BTF [M] /home/randark/linux/module.ko\\nSkipping BTF generation for /home/randark/linux/module.ko due to unavailability of vmlinux\\nmake[1]: Leaving directory \'/usr/src/linux-headers-6.2.0-35-generic\'\\ndwarfdump -di module.ko > module.dwarf\\nmake -C //lib/modules/6.2.0-35-generic/build M=\\"/home/randark/linux\\" clean\\nmake[1]: Entering directory \'/usr/src/linux-headers-6.2.0-35-generic\'\\n  CLEAN   /home/randark/linux/Module.symvers\\nmake[1]: Leaving directory \'/usr/src/linux-headers-6.2.0-35-generic\'\\nrandark@randark-test:~/linux$ ls -lh\\ntotal 3.0M\\ndrwxrwxr-x 2 randark randark 4.0K 10 \u6708 24 23:54 kcore\\n-rw-rw-r-- 1 randark randark  384 10 \u6708 24 23:54 Makefile\\n-rw-rw-r-- 1 randark randark  314 10 \u6708 24 23:54 Makefile.enterprise\\n-rw-rw-r-- 1 randark randark  18K 10 \u6708 26 00:14 module.c\\n-rw-rw-r-- 1 randark randark 2.9M 10 \u6708 26 00:19 module.dwarf\\n```\\n\\n\u6210\u529f\u5f97\u5230\u4e86 dwarf \u5185\u6838\u8c03\u8bd5\u6587\u4ef6\u3002\u63a5\u4e0b\u6765\u83b7\u53d6 `System.map` \u5185\u5b58\u8868\u6587\u4ef6\\n\\n```shell\\nrandark@randark-test:~/linux$ ls -lh /boot/System.map-$(uname -r)\\n-rw------- 1 root root 7.7M 10 \u6708  6 17:29 /boot/System.map-6.2.0-35-generic\\n```\\n\\n\u786e\u5b9a `System.map` \u5185\u5b58\u8868\u6587\u4ef6\u7684\u8def\u5f84\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5f00\u59cb\u6253\u5305\u9002\u7528\u4e8e Volatility2 \u7684\u914d\u7f6e\u6587\u4ef6\uff1a\\n\\n```shell\\nrandark@randark-test:~/linux$ sudo zip $(lsb_release -i -s)_$(uname -r)_profile.zip module.dwarf /boot/System.map-$(uname -r)\\n  adding: module.dwarf (deflated 91%)\\n  adding: boot/System.map-6.2.0-35-generic (deflated 82%)\\n```\\n\\n\u6210\u529f\u5f97\u5230\u9002\u7528\u4e8e Volatility2 \u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4ee5\u53ca\u5185\u5b58\u955c\u50cf\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 Volatility2 \u8fdb\u884c\u5206\u6790\u3002\u9996\u5148\uff0c\u5c06\u5236\u4f5c\u597d\u7684\u914d\u7f6e\u6587\u4ef6\u52a0\u5165\u5230 Volatility2 \u7684\u914d\u7f6e\u6587\u4ef6\u6587\u4ef6\u5939\\n\\n```shell\\nrandark@memory-forensic:~$ mv Ubuntu_6.2.0-35-generic_profile.zip ./volatility2/volatility/plugins/overlays/linux/\\nrandark@memory-forensic:~$ python2 ./volatility2/vol.py --info | grep Profile\\nVolatility Foundation Volatility Framework 2.6.1\\nProfiles\\nLinuxUbuntu_6_2_0-35-generic_profilex64 - A Profile for Linux Ubuntu_6.2.0-35-generic_profile x64\\n......\\n```\\n\\n\u7136\u540e\u4f7f\u7528 profile \u8fdb\u884c\u5185\u5b58\u955c\u50cf\u7684\u89e3\u6790\\n\\n```bash\\nrandark@memory-forensic:~$ python2 ./volatility2/vol.py -f ~/out.lime linux_banner --profile=LinuxUbuntu_6_2_0-35-generic_profilex64\\nVolatility Foundation Volatility Framework 2.6.1\\nTraceback (most recent call last):\\n  File \\"./volatility2/vol.py\\", line 192, in <module>\\n    main()\\n  File \\"./volatility2/vol.py\\", line 183, in main\\n    command.execute()\\n  File \\"/home/randark/volatility2/volatility/plugins/linux/common.py\\", line 67, in execute\\n    commands.Command.execute(self, *args, **kwargs)\\n  File \\"/home/randark/volatility2/volatility/commands.py\\", line 116, in execute\\n    if not self.is_valid_profile(profs[self._config.PROFILE]()):\\n  File \\"/home/randark/volatility2/volatility/plugins/overlays/linux/linux.py\\", line 218, in __init__\\n    obj.Profile.__init__(self, *args, **kwargs)\\n  File \\"/home/randark/volatility2/volatility/obj.py\\", line 862, in __init__\\n    self.reset()\\n  File \\"/home/randark/volatility2/volatility/plugins/overlays/linux/linux.py\\", line 232, in reset\\n    self.load_vtypes()\\n  File \\"/home/randark/volatility2/volatility/plugins/overlays/linux/linux.py\\", line 269, in load_vtypes\\n    vtypesvar = dwarf.DWARFParser(dwarfdata).finalize()\\n  File \\"/home/randark/volatility2/volatility/dwarf.py\\", line 72, in __init__\\n    self.feed_line(line)\\n  File \\"/home/randark/volatility2/volatility/dwarf.py\\", line 163, in feed_line\\n    self.process_statement(**parsed) #pylint: disable-msg=W0142\\n  File \\"/home/randark/volatility2/volatility/dwarf.py\\", line 267, in process_statement\\n    d = data[\'DW_AT_data_member_location\']\\nKeyError: \'DW_AT_data_member_location\'\\n```\\n\\n\u7ecf\u8fc7\u5bf9\u8fd9\u4e2a\u62a5\u9519\u7684\u8ddf\u8e2a\uff0c\u53d1\u73b0\u5df2\u6709\u4eba\u63d0\u51fa\u4e86\u76f8\u5173 issue\uff1a[Linux Profile Error - KeyError: \'DW_AT_data_member_location\' #828](https://github.com/volatilityfoundation/volatility/issues/828)\\n\\n\u6839\u636e issue \u7684\u53d1\u5c55\u5386\u53f2\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u95ee\u9898\u7684\u8d77\u56e0\u662f Volatility2 \u5bf9\u4e8e\u65b0\u7248 dwarfdump \u751f\u6210\u7684 dwarf \u6587\u4ef6\u7684\u652f\u6301\u6027\u4e0d\u52a0\u6240\u5bfc\u81f4\u7684\u3002\u5c06\u524d\u8f88\u6240\u5236\u4f5c\u7684\u65b0\u7248 `dwarf.py` [volatility/dwarf.py](https://github.com/volatilityfoundation/volatility/blob/7113c441d74a8fa1b8d5c056e77900e500453287/volatility/dwarf.py) \u66ff\u6362\u6389\u539f\u7248 Volatility2 \u7684 `dwarf.py` \u6587\u4ef6\\n\\n```shell\\nrandark@memory-forensic:~/volatility2/volatility$ ls -lh | grep dwarf\\n-rw-rw-r-- 1 randark randark  15K 10 \u6708 24 23:54 dwarf.py\\nrandark@memory-forensic:~/volatility2/volatility$ mv dwarf.py dwarf.py.bak\\nrandark@memory-forensic:~/volatility2/volatility$ nano dwarf.py\\nrandark@memory-forensic:~/volatility2/volatility$ ls -lh | grep dwarf\\n-rw-rw-r-- 1 randark randark  16K 10 \u6708 26 00:48 dwarf.py\\n-rw-rw-r-- 1 randark randark  15K 10 \u6708 24 23:54 dwarf.py.bak\\n```\\n\\n\u518d\u6b21\u5c1d\u8bd5\u5206\u6790\uff1a\\n\\n```shell\\nrandark@memory-forensic:~$ python2 ./volatility2/vol.py -f ~/out.lime --profile=LinuxUbuntu_6_2_0-35-generic_profilex64 linux_banner\\nVolatility Foundation Volatility Framework 2.6.1\\nWARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes\\nWARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes\\nNo suitable address space mapping found\\nTried to open image as:\\n MachOAddressSpace: mac: need base\\n LimeAddressSpace: lime: need base\\n WindowsHiberFileSpace32: No base Address Space\\n WindowsCrashDumpSpace64BitMap: No base Address Space\\n WindowsCrashDumpSpace64: No base Address Space\\n HPAKAddressSpace: No base Address Space\\n VMWareMetaAddressSpace: No base Address Space\\n VirtualBoxCoreDumpElf64: No base Address Space\\n VMWareAddressSpace: No base Address Space\\n QemuCoreDumpElf: No base Address Space\\n WindowsCrashDumpSpace32: No base Address Space\\n SkipDuplicatesAMD64PagedMemory: No base Address Space\\n WindowsAMD64PagedMemory: No base Address Space\\n LinuxAMD64PagedMemory: No base Address Space\\n AMD64PagedMemory: No base Address Space\\n IA32PagedMemoryPae: No base Address Space\\n IA32PagedMemory: No base Address Space\\n OSXPmemELF: No base Address Space\\n MachOAddressSpace: MachO Header signature invalid\\n MachOAddressSpace: MachO Header signature invalid\\n LimeAddressSpace: Invalid Lime header signature\\n WindowsHiberFileSpace32: PO_MEMORY_IMAGE is not available in profile\\n WindowsCrashDumpSpace64BitMap: Header signature invalid\\n WindowsCrashDumpSpace64: Header signature invalid\\n HPAKAddressSpace: Invalid magic found\\n VMWareMetaAddressSpace: VMware metadata file is not available\\n VirtualBoxCoreDumpElf64: ELF Header signature invalid\\n VMWareAddressSpace: Invalid VMware signature: -\\n QemuCoreDumpElf: ELF Header signature invalid\\n WindowsCrashDumpSpace32: Header signature invalid\\n SkipDuplicatesAMD64PagedMemory: Incompatible profile LinuxUbuntu_6_2_0-35-generic_profilex64 selected\\n WindowsAMD64PagedMemory: Incompatible profile LinuxUbuntu_6_2_0-35-generic_profilex64 selected\\n LinuxAMD64PagedMemory - EXCEPTION: \'state\'\\n AMD64PagedMemory - EXCEPTION: \'state\'\\n IA32PagedMemoryPae: Incompatible profile LinuxUbuntu_6_2_0-35-generic_profilex64 selected\\n IA32PagedMemory: Incompatible profile LinuxUbuntu_6_2_0-35-generic_profilex64 selected\\n OSXPmemELF: ELF Header signature invalid\\n FileAddressSpace: Must be first Address Space\\n ArmAddressSpace - EXCEPTION: \'state\'\\n```\\n\\n\u5f88\u4e0d\u5e78\uff0c\u4f9d\u7136\u5b58\u5728\u95ee\u9898\u3002\u6839\u636e\u95ee\u9898\u7ec6\u8282\uff0c\u53ef\u4ee5\u8ffd\u8e2a\u5230\u8fd9\u4e2a issue\uff1a[Update Linux DTB scanner to handle newer Linux kernel versions (>= 5.14-rc1) #852](https://github.com/volatilityfoundation/volatility/pull/852)\\n\\n\u6839\u636e issue \u4e2d\u524d\u8f88\u4eec\u7ed9\u51fa\u7684\u65b9\u6848\uff0c\u5c06\u8fd9\u4e24\u4e2a PR \u505a\u51fa\u7684\u66f4\u6539\u52a0\u5165\u5230\u672c\u5730\u7684 Volatility2 \u6e90\u7801\u4e2d\\n\\n- [Update Linux DTB scanner to handle newer Linux kernel versions (>= 5.14-rc1) #852](https://github.com/volatilityfoundation/volatility/pull/852/commits/9ff9e9bb9103d63cbb278e991209aa11cffc61ce)\\n\\n![PR #852 #1](img/image_20231058-005841.png)\\n\\n- [Update Linux DTB scanner to handle newer Linux kernel versions (>= 5.14-rc1) #852](https://github.com/volatilityfoundation/volatility/pull/852/commits/d07c69a7811d8e18ab186c9fbdf5b050529d06d2)\\n\\n![PR #852 #2](img/image_20231000-010045.png)\\n\\n\u7ee7\u7eed\u5c1d\u8bd5\u5206\u6790\uff1a\\n\\n```shell\\nrandark@memory-forensic:~$ python2 ./volatility2/vol.py -f ~/out.lime --profile=LinuxUbuntu_6_2_0-35-generic_profilex64 linux_banner\\nVolatility Foundation Volatility Framework 2.6.1\\nWARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes\\nWARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes\\nLinux version 6.2.0-35-generic (buildd@bos03-amd64-016) (x86_64-linux-gnu-gcc-11 (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0, GNU ld (GNU Binutils for Ubuntu) 2.38) #35~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Oct  6 10:23:26 UTC 2 (Ubuntu 6.2.0-35.35~22.04.1-gene\\n```\\n\\n\u6210\u529f\u57fa\u4e8e\u914d\u7f6e\u6587\u4ef6\uff0c\u5b9e\u73b0\u5bf9\u5185\u5b58\u955c\u50cf\u7684\u8bfb\u53d6\u5206\u6790\\n\\n---\\n\\n### \u53c2\u8003\u8d44\u6599\\n\\n[How to generate a Volatility profile for a Linux system](https://andreafortuna.org/2019/08/22/how-to-generate-a-volatility-profile-for-a-linux-system/)"}]}')}}]);