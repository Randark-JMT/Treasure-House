<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>http://treasure-house.randark.site/blog</id>
    <title>Randark_JMT Blog</title>
    <updated>2023-10-25T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="http://treasure-house.randark.site/blog"/>
    <subtitle>Randark_JMT Blog</subtitle>
    <icon>http://treasure-house.randark.site/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[内存取证实验 - 镜像 + 配置文件]]></title>
        <id>http://treasure-house.randark.site/blog/2023-10-25-MemoryForensic-Test</id>
        <link href="http://treasure-house.randark.site/blog/2023-10-25-MemoryForensic-Test"/>
        <updated>2023-10-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[新建虚拟机，使用 ubuntu-22.04.2-desktop-amd64.iso 作为安装镜像，正常完成安装，选择最小化安装，并且安装过程中不进行自动更新]]></summary>
        <content type="html"><![CDATA[<p>新建虚拟机，使用 <code>ubuntu-22.04.2-desktop-amd64.iso</code> 作为安装镜像，正常完成安装，选择最小化安装，并且安装过程中不进行自动更新</p><p><img loading="lazy" alt="Ubuntu install option" src="/assets/images/image_20231037-233754-7cad03aaa7d37dd3e9f21d09d9f8fe55.png" width="1280" height="768" class="img_ev3q"></p><p>等待安装完成后，为纯净状态制作快照</p><p><img loading="lazy" alt="Vmware Create Init Capture" src="/assets/images/image_20231046-234659-799a2dca4087bd107b3e36aa0e9ae902.png" width="1920" height="1058" class="img_ev3q"></p><p>然后安装必要的软件包：</p><ul><li>openssh-server</li><li>make</li><li>gcc</li><li>net-tools</li></ul><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> /etc/apt/sources.list /etc/apt/sources.list.bak</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">nano</span><span class="token plain"> /etc/apt/sources.list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 将 apt 的源仓库地址换为 ustc 中科大源</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> openssh-server gcc </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> net-tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Synchronizing state of ssh.service with SysV </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> script with /lib/systemd/systemd-sysv-install.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Executing: /lib/systemd/systemd-sysv-install </span><span class="token builtin class-name">enable</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> systemctl start </span><span class="token function" style="color:#d73a49">ssh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后，通过 ssh 与 sftp 进行操作：首先，将 <a href="https://github.com/microsoft/avml" target="_blank" rel="noopener noreferrer">AVML</a> 的二进制文件传输到测试机上，并授予执行权限，然后开始制作镜像</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~$ </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +x avml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> ./avml out.lime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -lh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">.1G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxrwxr-x </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> randark randark </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">.4M </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">26</span><span class="token plain"> 00:01 avml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw------- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root    root    </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">.0G </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">26</span><span class="token plain"> 00:02 out.lime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwx------ </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> randark randark </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">.0K </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">:52 snap</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>成功得到 <code>out.lime</code> 内存镜像文件</p><p>接下来，开始构建 <code>dwarf</code> 内核调试文件，与获取 <code>System.map</code> 内存表文件</p><p>首先，确定 Linux Kernel 的版本</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~$ </span><span class="token function" style="color:#d73a49">uname</span><span class="token plain"> -a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Linux randark-test </span><span class="token number" style="color:#36acaa">6.2</span><span class="token plain">.0-35-generic </span><span class="token comment" style="color:#999988;font-style:italic">#35~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Oct  6 10:23:26 UTC 2 x86_64 x86_64 x86_64 GNU/Linux</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后传输 dwarf 内核调试文件的编译文件：<a href="https://github.com/volatilityfoundation/volatility/tree/master/tools/linux" target="_blank" rel="noopener noreferrer">volatility/tools/linux</a>，并尝试进行编译</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~/linux$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -lh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total 32K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxrwxr-x </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> randark randark </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">.0K </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">:54 kcore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> randark randark  </span><span class="token number" style="color:#36acaa">384</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">:54 Makefile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> randark randark  </span><span class="token number" style="color:#36acaa">314</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">:54 Makefile.enterprise</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> randark randark  18K </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">:54 module.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~/linux$ </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> -C //lib/modules/6.2.0-35-generic/build </span><span class="token assign-left variable" style="color:#36acaa">CONFIG_DEBUG_INFO</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">y </span><span class="token assign-left variable" style="color:#36acaa">M</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"/home/randark/linux"</span><span class="token plain"> modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: Entering directory </span><span class="token string" style="color:#e3116c">'/usr/src/linux-headers-6.2.0-35-generic'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warning: the compiler differs from the one used to build the kernel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  The kernel was built by: x86_64-linux-gnu-gcc-11 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Ubuntu </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0-1ubuntu1~22.04</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  You are using:           gcc-11 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Ubuntu </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0-1ubuntu1~22.04</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">M</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  /home/randark/linux/module.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/home/randark/linux/module.c:136: warning: </span><span class="token string" style="color:#e3116c">"__rcu"</span><span class="token plain"> redefined</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">136</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#define __rcu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> included from </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">command-line</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">././include/linux/compiler_types.h:52: note: this is the location of the previous definition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">52</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># define __rcu          BTF_TYPE_TAG(rcu)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MODPOST /home/randark/linux/Module.symvers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR: modpost: missing MODULE_LICENSE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> /home/randark/linux/module.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: *** </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">scripts/Makefile.modpost:138: /home/randark/linux/Module.symvers</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Error </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: *** </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Makefile:1978: modpost</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Error </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: Leaving directory </span><span class="token string" style="color:#e3116c">'/usr/src/linux-headers-6.2.0-35-generic'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make: *** </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Makefile:10: dwarf</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Error </span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可以发现编译过程中存在致命错误：<code>modpost: missing MODULE_LICENSE() in /home/randark/linux/module.o</code></p><p>在 <code>module.c</code> 的文件末尾加上以下语句：</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">MODULE_LICENSE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"GPL"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>或者执行：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'MODULE_LICENSE("GPL");'</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> module.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>继续尝试编译：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~/linux$ </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> -C //lib/modules/6.2.0-35-generic/build </span><span class="token assign-left variable" style="color:#36acaa">CONFIG_DEBUG_INFO</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">y </span><span class="token assign-left variable" style="color:#36acaa">M</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"/home/randark/linux"</span><span class="token plain"> modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: Entering directory </span><span class="token string" style="color:#e3116c">'/usr/src/linux-headers-6.2.0-35-generic'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warning: the compiler differs from the one used to build the kernel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  The kernel was built by: x86_64-linux-gnu-gcc-11 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Ubuntu </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0-1ubuntu1~22.04</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  You are using:           gcc-11 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Ubuntu </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0-1ubuntu1~22.04</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">M</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  /home/randark/linux/module.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/home/randark/linux/module.c:136: warning: </span><span class="token string" style="color:#e3116c">"__rcu"</span><span class="token plain"> redefined</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">136</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#define __rcu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> included from </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">command-line</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">././include/linux/compiler_types.h:52: note: this is the location of the previous definition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">52</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># define __rcu          BTF_TYPE_TAG(rcu)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MODPOST /home/randark/linux/Module.symvers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">M</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  /home/randark/linux/module.mod.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  LD </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">M</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  /home/randark/linux/module.ko</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BTF </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">M</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> /home/randark/linux/module.ko</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Skipping BTF generation </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> /home/randark/linux/module.ko due to unavailability of vmlinux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: Leaving directory </span><span class="token string" style="color:#e3116c">'/usr/src/linux-headers-6.2.0-35-generic'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwarfdump -di module.ko </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> module.dwarf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/bin/sh: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">: dwarfdump: not found</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>继续发现存在致命错误：<code>/bin/sh: 1: dwarfdump: not found</code></p><p>查阅相关文档 <a href="https://github.com/volatilityfoundation/volatility/wiki/Linux#creating-a-new-profile" target="_blank" rel="noopener noreferrer">Creating a new profile</a> 后，得知需要安装以下工具：</p><ul><li>dwarfdump</li></ul><p>继续尝试编译：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~/linux$ </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> -C //lib/modules/6.2.0-35-generic/build </span><span class="token assign-left variable" style="color:#36acaa">CONFIG_DEBUG_INFO</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">y </span><span class="token assign-left variable" style="color:#36acaa">M</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"/home/randark/linux"</span><span class="token plain"> modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: Entering directory </span><span class="token string" style="color:#e3116c">'/usr/src/linux-headers-6.2.0-35-generic'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warning: the compiler differs from the one used to build the kernel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  The kernel was built by: x86_64-linux-gnu-gcc-11 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Ubuntu </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0-1ubuntu1~22.04</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  You are using:           gcc-11 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Ubuntu </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0-1ubuntu1~22.04</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">M</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  /home/randark/linux/module.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/home/randark/linux/module.c:136: warning: </span><span class="token string" style="color:#e3116c">"__rcu"</span><span class="token plain"> redefined</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">136</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#define __rcu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> included from </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">command-line</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">././include/linux/compiler_types.h:52: note: this is the location of the previous definition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">52</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># define __rcu          BTF_TYPE_TAG(rcu)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MODPOST /home/randark/linux/Module.symvers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CC </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">M</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  /home/randark/linux/module.mod.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  LD </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">M</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  /home/randark/linux/module.ko</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BTF </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">M</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> /home/randark/linux/module.ko</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Skipping BTF generation </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> /home/randark/linux/module.ko due to unavailability of vmlinux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: Leaving directory </span><span class="token string" style="color:#e3116c">'/usr/src/linux-headers-6.2.0-35-generic'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwarfdump -di module.ko </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> module.dwarf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> -C //lib/modules/6.2.0-35-generic/build </span><span class="token assign-left variable" style="color:#36acaa">M</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"/home/randark/linux"</span><span class="token plain"> clean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: Entering directory </span><span class="token string" style="color:#e3116c">'/usr/src/linux-headers-6.2.0-35-generic'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CLEAN   /home/randark/linux/Module.symvers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: Leaving directory </span><span class="token string" style="color:#e3116c">'/usr/src/linux-headers-6.2.0-35-generic'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~/linux$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -lh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">.0M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxrwxr-x </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> randark randark </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">.0K </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">:54 kcore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> randark randark  </span><span class="token number" style="color:#36acaa">384</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">:54 Makefile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> randark randark  </span><span class="token number" style="color:#36acaa">314</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">:54 Makefile.enterprise</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> randark randark  18K </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">26</span><span class="token plain"> 00:14 module.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> randark randark </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">.9M </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月 </span><span class="token number" style="color:#36acaa">26</span><span class="token plain"> 00:19 module.dwarf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>成功得到了 dwarf 内核调试文件。接下来获取 <code>System.map</code> 内存表文件</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~/linux$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -lh /boot/System.map-</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">uname</span><span class="token variable" style="color:#36acaa"> -r</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw------- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">.7M </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> 月  </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:29 /boot/System.map-6.2.0-35-generic</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>确定 <code>System.map</code> 内存表文件的路径之后，就可以开始打包适用于 Volatility2 的配置文件：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@randark-test:~/linux$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">zip</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">lsb_release -i -s</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain">_</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">uname</span><span class="token variable" style="color:#36acaa"> -r</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain">_profile.zip module.dwarf /boot/System.map-</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">uname</span><span class="token variable" style="color:#36acaa"> -r</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  adding: module.dwarf </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">deflated </span><span class="token number" style="color:#36acaa">91</span><span class="token plain">%</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  adding: boot/System.map-6.2.0-35-generic </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">deflated </span><span class="token number" style="color:#36acaa">82</span><span class="token plain">%</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>成功得到适用于 Volatility2 的配置文件，以及内存镜像之后，就可以使用 Volatility2 进行分析。首先，将制作好的配置文件加入到 Volatility2 的配置文件文件夹</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@memory-forensic:~$ </span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> Ubuntu_6.2.0-35-generic_profile.zip ./volatility2/volatility/plugins/overlays/linux/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@memory-forensic:~$ python2 ./volatility2/vol.py --info </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> Profile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility Foundation Volatility Framework </span><span class="token number" style="color:#36acaa">2.6</span><span class="token plain">.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Profiles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LinuxUbuntu_6_2_0-35-generic_profilex64 - A Profile </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> Linux Ubuntu_6.2.0-35-generic_profile x64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后使用 profile 进行内存镜像的解析</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@memory-forensic:~$ python2 ./volatility2/vol.py -f ~/out.lime linux_banner --profile</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">LinuxUbuntu_6_2_0-35-generic_profilex64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility Foundation Volatility Framework </span><span class="token number" style="color:#36acaa">2.6</span><span class="token plain">.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Traceback </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">most recent call last</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"./volatility2/vol.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">192</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">module</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"./volatility2/vol.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">183</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    command.execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"/home/randark/volatility2/volatility/plugins/linux/common.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">67</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> execute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    commands.Command.execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self, *args, **kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"/home/randark/volatility2/volatility/commands.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">116</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> execute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> not self.is_valid_profile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">profs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">self._config.PROFILE</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"/home/randark/volatility2/volatility/plugins/overlays/linux/linux.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">218</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> __init__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    obj.Profile.__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self, *args, **kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"/home/randark/volatility2/volatility/obj.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">862</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> __init__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    self.reset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"/home/randark/volatility2/volatility/plugins/overlays/linux/linux.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">232</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> reset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    self.load_vtypes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"/home/randark/volatility2/volatility/plugins/overlays/linux/linux.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">269</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> load_vtypes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vtypesvar </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dwarf.DWARFParser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dwarfdata</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">.finalize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"/home/randark/volatility2/volatility/dwarf.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">72</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> __init__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    self.feed_line</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">line</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"/home/randark/volatility2/volatility/dwarf.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">163</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> feed_line</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    self.process_statement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">**parsed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#pylint: disable-msg=W0142</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  File </span><span class="token string" style="color:#e3116c">"/home/randark/volatility2/volatility/dwarf.py"</span><span class="token plain">, line </span><span class="token number" style="color:#36acaa">267</span><span class="token plain">, </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> process_statement</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'DW_AT_data_member_location'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyError: </span><span class="token string" style="color:#e3116c">'DW_AT_data_member_location'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>经过对这个报错的跟踪，发现已有人提出了相关 issue：<a href="https://github.com/volatilityfoundation/volatility/issues/828" target="_blank" rel="noopener noreferrer">Linux Profile Error - KeyError: 'DW_AT_data_member_location' #828</a></p><p>根据 issue 的发展历史，可以定位到问题的起因是 Volatility2 对于新版 dwarfdump 生成的 dwarf 文件的支持性不加所导致的。将前辈所制作的新版 <code>dwarf.py</code> <a href="https://github.com/volatilityfoundation/volatility/blob/7113c441d74a8fa1b8d5c056e77900e500453287/volatility/dwarf.py" target="_blank" rel="noopener noreferrer">volatility/dwarf.py</a> 替换掉原版 Volatility2 的 <code>dwarf.py</code> 文件</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@memory-forensic:~/volatility2/volatility$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -lh </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> dwarf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> randark randark  15K </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">月 </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">:54 dwarf.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@memory-forensic:~/volatility2/volatility$ </span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> dwarf.py dwarf.py.bak</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@memory-forensic:~/volatility2/volatility$ </span><span class="token function" style="color:#d73a49">nano</span><span class="token plain"> dwarf.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randark@memory-forensic:~/volatility2/volatility$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -lh </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> dwarf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> randark randark  16K </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">月 </span><span class="token number" style="color:#36acaa">26</span><span class="token plain"> 00:48 dwarf.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> randark randark  15K </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">月 </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">:54 dwarf.py.bak</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>再次尝试分析：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@memory-forensic:~$ python2 ./volatility2/vol.py -f ~/out.lime --profile</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">LinuxUbuntu_6_2_0-35-generic_profilex64 linux_banner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility Foundation Volatility Framework </span><span class="token number" style="color:#36acaa">2.6</span><span class="token plain">.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING </span><span class="token builtin class-name">:</span><span class="token plain"> volatility.debug    </span><span class="token builtin class-name">:</span><span class="token plain"> Overlay structure cpuinfo_x86 not present </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> vtypes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING </span><span class="token builtin class-name">:</span><span class="token plain"> volatility.debug    </span><span class="token builtin class-name">:</span><span class="token plain"> Overlay structure cpuinfo_x86 not present </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> vtypes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No suitable address space mapping found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tried to </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"> image as:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> MachOAddressSpace: mac: need base</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> LimeAddressSpace: lime: need base</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WindowsHiberFileSpace32: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WindowsCrashDumpSpace64BitMap: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WindowsCrashDumpSpace64: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> HPAKAddressSpace: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> VMWareMetaAddressSpace: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> VirtualBoxCoreDumpElf64: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> VMWareAddressSpace: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> QemuCoreDumpElf: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WindowsCrashDumpSpace32: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> SkipDuplicatesAMD64PagedMemory: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WindowsAMD64PagedMemory: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> LinuxAMD64PagedMemory: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> AMD64PagedMemory: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> IA32PagedMemoryPae: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> IA32PagedMemory: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> OSXPmemELF: No base Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> MachOAddressSpace: MachO Header signature invalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> MachOAddressSpace: MachO Header signature invalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> LimeAddressSpace: Invalid Lime header signature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WindowsHiberFileSpace32: PO_MEMORY_IMAGE is not available </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> profile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WindowsCrashDumpSpace64BitMap: Header signature invalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WindowsCrashDumpSpace64: Header signature invalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> HPAKAddressSpace: Invalid magic found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> VMWareMetaAddressSpace: VMware metadata </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> is not available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> VirtualBoxCoreDumpElf64: ELF Header signature invalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> VMWareAddressSpace: Invalid VMware signature: -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> QemuCoreDumpElf: ELF Header signature invalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WindowsCrashDumpSpace32: Header signature invalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> SkipDuplicatesAMD64PagedMemory: Incompatible profile LinuxUbuntu_6_2_0-35-generic_profilex64 selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WindowsAMD64PagedMemory: Incompatible profile LinuxUbuntu_6_2_0-35-generic_profilex64 selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> LinuxAMD64PagedMemory - EXCEPTION: </span><span class="token string" style="color:#e3116c">'state'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> AMD64PagedMemory - EXCEPTION: </span><span class="token string" style="color:#e3116c">'state'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> IA32PagedMemoryPae: Incompatible profile LinuxUbuntu_6_2_0-35-generic_profilex64 selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> IA32PagedMemory: Incompatible profile LinuxUbuntu_6_2_0-35-generic_profilex64 selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> OSXPmemELF: ELF Header signature invalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> FileAddressSpace: Must be first Address Space</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ArmAddressSpace - EXCEPTION: </span><span class="token string" style="color:#e3116c">'state'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>很不幸，依然存在问题。根据问题细节，可以追踪到这个issue：<a href="https://github.com/volatilityfoundation/volatility/pull/852" target="_blank" rel="noopener noreferrer">Update Linux DTB scanner to handle newer Linux kernel versions (&gt;= 5.14-rc1) #852</a></p><p>根据issue中前辈们给出的方案，将这两个PR做出的更改加入到本地的Volatility2源码中</p><ul><li><a href="https://github.com/volatilityfoundation/volatility/pull/852/commits/9ff9e9bb9103d63cbb278e991209aa11cffc61ce" target="_blank" rel="noopener noreferrer">Update Linux DTB scanner to handle newer Linux kernel versions (&gt;= 5.14-rc1) #852</a></li></ul><p><img loading="lazy" alt="PR #852 #1" src="/assets/images/image_20231058-005841-92ad9c9cdf57c3591cad8f7e85e695a9.png" width="1920" height="1050" class="img_ev3q"></p><ul><li><a href="https://github.com/volatilityfoundation/volatility/pull/852/commits/d07c69a7811d8e18ab186c9fbdf5b050529d06d2" target="_blank" rel="noopener noreferrer">Update Linux DTB scanner to handle newer Linux kernel versions (&gt;= 5.14-rc1) #852</a></li></ul><p><img loading="lazy" alt="PR #852 #2" src="/assets/images/image_20231000-010045-67fae8021f55ac57dc3e9a23836f17a3.png" width="1920" height="1050" class="img_ev3q"></p><p>继续尝试分析：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">randark@memory-forensic:~$ python2 ./volatility2/vol.py -f ~/out.lime --profile</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">LinuxUbuntu_6_2_0-35-generic_profilex64 linux_banner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility Foundation Volatility Framework </span><span class="token number" style="color:#36acaa">2.6</span><span class="token plain">.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING </span><span class="token builtin class-name">:</span><span class="token plain"> volatility.debug    </span><span class="token builtin class-name">:</span><span class="token plain"> Overlay structure cpuinfo_x86 not present </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> vtypes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING </span><span class="token builtin class-name">:</span><span class="token plain"> volatility.debug    </span><span class="token builtin class-name">:</span><span class="token plain"> Overlay structure cpuinfo_x86 not present </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> vtypes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Linux version </span><span class="token number" style="color:#36acaa">6.2</span><span class="token plain">.0-35-generic </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buildd@bos03-amd64-016</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86_64-linux-gnu-gcc-11 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Ubuntu </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0-1ubuntu1~22.04</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11.4</span><span class="token plain">.0, GNU ld </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GNU Binutils </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> Ubuntu</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.38</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#35~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Oct  6 10:23:26 UTC 2 (Ubuntu 6.2.0-35.35~22.04.1-gene</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>成功基于配置文件，实现对内存镜像的读取分析</p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="参考资料">参考资料<a href="#参考资料" class="hash-link" aria-label="参考资料的直接链接" title="参考资料的直接链接">​</a></h3><p><a href="https://andreafortuna.org/2019/08/22/how-to-generate-a-volatility-profile-for-a-linux-system/" target="_blank" rel="noopener noreferrer">How to generate a Volatility profile for a Linux system</a></p>]]></content>
        <author>
            <name>陈橘mo</name>
            <uri>https://randark.site</uri>
        </author>
    </entry>
</feed>