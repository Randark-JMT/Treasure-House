<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-CTF-Research/Archives/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">压缩包相关 | Randark_JMT</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="http://treasure-house.randark.site/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="http://treasure-house.randark.site/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="http://treasure-house.randark.site/docs/CTF-Research/Archives/"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="压缩包相关 | Randark_JMT"><meta data-rh="true" name="description" content="在 Misc 领域中，关于压缩包的知识是很基本的，近几年被考烂的；但同时也是每位 Misc 手，乃至每位 CTFer 都应该了解的重要知识点。在 Misc 领域，关于压缩包分析的知识可以说占了一大部分。而其中又包括了像文件数据结构的识别、 CRC 数据校验算法等等知识点。"><meta data-rh="true" property="og:description" content="在 Misc 领域中，关于压缩包的知识是很基本的，近几年被考烂的；但同时也是每位 Misc 手，乃至每位 CTFer 都应该了解的重要知识点。在 Misc 领域，关于压缩包分析的知识可以说占了一大部分。而其中又包括了像文件数据结构的识别、 CRC 数据校验算法等等知识点。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="http://treasure-house.randark.site/docs/CTF-Research/Archives/"><link data-rh="true" rel="alternate" href="http://treasure-house.randark.site/docs/CTF-Research/Archives/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="http://treasure-house.randark.site/docs/CTF-Research/Archives/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Randark_JMT RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Randark_JMT Atom Feed"><link rel="stylesheet" href="/assets/css/styles.e35f31ef.css">
<link rel="preload" href="/assets/js/runtime~main.98fc27d7.js" as="script">
<link rel="preload" href="/assets/js/main.c88a2240.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.jpg" alt="Randark_JMT" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.jpg" alt="Randark_JMT" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Treasure-House</b></a><a class="navbar__item navbar__link" href="/docs/Environment/">环境配置</a><a class="navbar__item navbar__link" href="/docs/Devops/">开发部署</a><a class="navbar__item navbar__link" href="/docs/Penetration/">渗透测试</a><a class="navbar__item navbar__link" href="/docs/Attack-Defense/">红蓝攻防</a><a class="navbar__item navbar__link" href="/docs/Forensic/">电子取证</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/CTF-Research/">CTF研究</a></div><div class="navbar__items navbar__items--right"><a href="https://randark.site/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">主站<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/Randark-JMT" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item green"><a class="menu__link" href="/docs/CTF-Research/">CTF研究</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" href="/docs/CTF-Research/Archives/">压缩包相关</a><button aria-label="打开/收起侧边栏菜单「压缩包相关」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CTF-Research/Archives/ZIP-Bomb">zip 压缩包炸弹</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">压缩包相关</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>压缩包相关</h1><p>在 Misc 领域中，关于压缩包的知识是很基本的，近几年被考烂的；但同时也是每位 Misc 手，乃至每位 CTFer 都应该了解的重要知识点。在 Misc 领域，关于压缩包分析的知识可以说占了一大部分。而其中又包括了像文件数据结构的识别、 CRC 数据校验算法等等知识点。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="zip-文件">ZIP 文件<a href="#zip-文件" class="hash-link" aria-label="ZIP 文件的直接链接" title="ZIP 文件的直接链接">​</a></h2><p>ZIP 文件格式是一种数据压缩和文档储存的文件格式，原名 Deflate，发明者为菲尔 · 卡茨（Phil Katz），他于 1989 年 1 月公布了该格式的资料。ZIP 通常使用后缀名 “.zip”，它的 MIME 格式为 <code>application/zip</code>。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="zip-文件结构">zip 文件结构<a href="#zip-文件结构" class="hash-link" aria-label="zip 文件结构的直接链接" title="zip 文件结构的直接链接">​</a></h3><p>一个 ZIP 文件由三个部分组成：压缩源文件数据区 + 压缩源文件目录区 + 压缩源文件目录结束标志</p><p>这里拿一个小的测试用 zip 文件举例：</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="zip-文件源数据区">zip 文件源数据区<a href="#zip-文件源数据区" class="hash-link" aria-label="zip 文件源数据区的直接链接" title="zip 文件源数据区的直接链接">​</a></h4><p><code>struct ZIPFILERECORD record</code></p><p><img loading="lazy" alt="ZIPFILERECORD hex" src="/assets/images/image_20230855-225513-c096ff0027af4a99f30211da0d009aaf.png" width="1920" height="1042" class="img_ev3q"></p><p><img loading="lazy" alt="ZIPFILERECORD format" src="/assets/images/image_20230855-225549-a7a4fbd363404f7a9128f01c55ac8f98.png" width="669" height="215" class="img_ev3q"></p><table><thead><tr><th>HEX 数据</th><th>描述</th><th>010Editor 模板数据</th></tr></thead><tbody><tr><td>50 4B 03 04</td><td>zip 文件头标记，看文本的话就是 PK 开头</td><td>char frSignature<!-- -->[4]</td></tr><tr><td>0A 00</td><td>解压文件所需 pkware 版本</td><td>ushort frVersion</td></tr><tr><td>00 00</td><td>全局方式位标记（有无加密），头文件标记后 2bytes</td><td>ushort frFlags</td></tr><tr><td>00 00</td><td>压缩方式</td><td>enum COMPTYPE frCompression</td></tr><tr><td>E8 A6</td><td>最后修改文件时间</td><td>DOSTIME frFileTime</td></tr><tr><td>32 53</td><td>最后修改文件日期</td><td>DOSDATE frFileDate</td></tr><tr><td>0C 7E 7F D8</td><td>CRC-32 校验</td><td>uint frCrc</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="zip-文件源数据目录区">zip 文件源数据目录区<a href="#zip-文件源数据目录区" class="hash-link" aria-label="zip 文件源数据目录区的直接链接" title="zip 文件源数据目录区的直接链接">​</a></h4><p><code>struct ZIPDIRENTRY dirEntry</code></p><p><img loading="lazy" alt="ZIPDIRENTRY hex" src="/assets/images/image_20230856-225650-ad4e213b84704ff2e59d1e9e633357ae.png" width="1920" height="1042" class="img_ev3q"></p><p><img loading="lazy" alt="ZIPDIRENTRY format" src="/assets/images/image_20230857-225722-29120092b0d0086e2c8a968945a913f9.png" width="729" height="327" class="img_ev3q"></p><table><thead><tr><th>HEX 数据</th><th>描述</th><th>010Editor 模板数据</th></tr></thead><tbody><tr><td>50 4B 01 02</td><td>目录中文件文件头标记</td><td>char deSignature<!-- -->[4]</td></tr><tr><td>3F 00</td><td>压缩使用的 pkware 版本</td><td>ushort deVersionMadeBy</td></tr><tr><td>0A 00</td><td>解压文件所需 pkware 版本</td><td>ushort deVersionToExtract</td></tr><tr><td>00 00</td><td>全局方式位标记（有无加密），目录文件标记后 4bytes</td><td>ushort frFlags</td></tr><tr><td>00 00</td><td>压缩方式</td><td>enum COMPTYPE frCompression</td></tr><tr><td>E8 A6</td><td>最后修改文件时间</td><td>DOSTIME frFileTime</td></tr><tr><td>32 53</td><td>最后修改文件日期</td><td>DOSDATE frFileDate</td></tr><tr><td>0C 7E 7F D8</td><td>CRC-32 校验</td><td>uint frCrc</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="zip-文件源数据目录结束区">zip 文件源数据目录结束区<a href="#zip-文件源数据目录结束区" class="hash-link" aria-label="zip 文件源数据目录结束区的直接链接" title="zip 文件源数据目录结束区的直接链接">​</a></h4><p><code>struct ZIPENDLOCATOR endLocator</code></p><p><img loading="lazy" alt="ZIPENDLOCATOR hex" src="/assets/images/image_20230857-225753-a6d5b47a586f3498b78a8f6658e501a7.png" width="1920" height="1042" class="img_ev3q"></p><table><thead><tr><th>HEX 数据</th><th>描述</th><th>010Editor 模板数据</th></tr></thead><tbody><tr><td>50 4B 05 06</td><td>目录结束标记</td><td>char elSignature<!-- -->[4]</td></tr><tr><td>00 00</td><td>当前磁盘编号</td><td>ushort elDiskNumber</td></tr><tr><td>00 00</td><td>目录区开始磁盘编号</td><td>ushort elStartDiskNumber</td></tr></tbody></table><p>对于多文件的压缩包，其结构不会如此简单，但按照格式依然可以对照得出：</p><p><img loading="lazy" alt="multi files" src="/assets/images/image_20230858-225821-1b84c8337e57f8c5bde394e930eda2b1.png" width="1920" height="1042" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="zip-文件常见考点">zip 文件常见考点<a href="#zip-文件常见考点" class="hash-link" aria-label="zip 文件常见考点的直接链接" title="zip 文件常见考点的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="0x01-zip-伪加密">0x01 zip 伪加密<a href="#0x01-zip-伪加密" class="hash-link" aria-label="0x01 zip 伪加密的直接链接" title="0x01 zip 伪加密的直接链接">​</a></h4><p>zip 文件的伪加密，正如他的名字，即虽然 zip 文件本身没有加密，但是通过修改 zip 文件中的标记数据，让解压软件认为文件存在加密，故达到了伪加密的效果。而标记 zip 文件是否加密的标记，则是上文中 zip 文件源数据区中的 <code>ushort frFlags</code>（全局标记文件是否加密）和 zip 文件源数据目录区中的 ushort frFlags（全局标记文件是否加密，伪加密的关键点）两个位置。</p><p>在正常加密的情况下，源数据区的加密标记和源文件目录区的加密标志点应当是同一个数据，然而在一般的 zip 伪加密中，往往 zip 文件源数据区中的 ushort frFlags 数据点为 0，偶数即标志着文件不存在加密，但是 zip 文件源数据目录区中的 ushort frFlags 数据点不为偶数，标志着文件存在加密。这样前后标志冲突，软件会认为 zip 文件存在加密，但是无论用什么密码都无法解压，因为文件数据根本没有加密。</p><p>在这种情况下，可以选择使用 16 进制编辑工具（推荐 010 Editor，用模板功能可以方便地定位标志数据的位置）来手动编辑文件数据，通过将 zip 文件源数据目录区中的 <code>ushort frFlags</code> 数据点中的数据全部改为 0，即可让文件认为文件不存在加密方式，就可以顺利解出数据。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="zip-伪加密---例题">zip 伪加密 - 例题<a href="#zip-伪加密---例题" class="hash-link" aria-label="zip 伪加密 - 例题的直接链接" title="zip 伪加密 - 例题的直接链接">​</a></h5><p><a href="https://buuoj.cn/challenges#zip%E4%BC%AA%E5%8A%A0%E5%AF%86" target="_blank" rel="noopener noreferrer">BUUCTF-zip 伪加密</a></p><p>这道题的 zip 附件下载下来直接解压，会发现解压出的 flag.txt 文件为空白，并提示输入密码。用十六进制编辑器看一下 zip 文件的数据：</p><p><img loading="lazy" alt="fake encrypt" src="/assets/images/image_20230858-225859-a63e60780013358c8227c73b951b0b51.png" width="1920" height="1042" class="img_ev3q"></p><p>根据题目提示，尝试把所有加密标记点改为 0：</p><p><img loading="lazy" alt="unfake" src="/assets/images/image_20230859-225936-ec041fd9700b04082a1827ea5fed4d9d.png" width="1920" height="1013" class="img_ev3q"></p><p>再尝试解压，便可以成功解压。</p><p>也可以尝试使用以下自动化脚本进行移除伪加密（原理是直接暴力修改加密标志位，并不会检测是否为真实的伪加密）</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> struct</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out_HEX </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">head </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">b&#x27;P&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&#x27;K&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;$ zip 伪加密自动解密脚本 $&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;\n\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    infile </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;D:\\Downloads\\test.zip&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rb&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> infile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># print(c)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> c </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> head</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_HEX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">ord</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;传入的非 zip 文件&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        i </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> infile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        out_HEX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">ord</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    infile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># print(out_HEX)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    len_out </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">out_HEX</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> len_out</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">75</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># zip 文件源数据区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zip 文件源数据区：&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> letter </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">letter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;--&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> letter </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">letter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zip 文件源数据区加密状态：&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_HEX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_HEX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_HEX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_HEX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">75</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># zip 文件源数据目录区</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zip 文件源数据目录区&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> letter </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">letter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;--&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> letter </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">letter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zip 文件源数据目录区加密状态：&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">out_HEX</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_HEX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_HEX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_HEX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_HEX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        i </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;D:\\Downloads\\out.zip&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;wb&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> outfile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> bytes_ </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> out_HEX</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># print(bytes_)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># print(struct.pack(&quot;B&quot;, bytes_))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            outfile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">struct</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;B&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bytes_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;文件已解密&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="0x02-爆破">0x02 爆破<a href="#0x02-爆破" class="hash-link" aria-label="0x02 爆破的直接链接" title="0x02 爆破的直接链接">​</a></h4><p>直接爆破密码可能是最常见，也是最无脑的 zip 文件考点了，现在依靠 ARCHPR 和 fcrackzip 这类工具，已经完全不需要用户手动编写脚本，单单依靠工具便可以十分轻松地暴力破解脚本。</p><p><img loading="lazy" alt="ARCHPR" src="/assets/images/image_20230801-230112-1785762e02dc61b4b9dedc3b9f08f648.png" width="579" height="566" class="img_ev3q"></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-纯暴力">1. 纯暴力<a href="#1-纯暴力" class="hash-link" aria-label="1. 纯暴力的直接链接" title="1. 纯暴力的直接链接">​</a></h5><p>同字面意思，尝试所有可能选项来爆破压缩包密码，耗时随密码复杂度和密码长度而无限增长。一般纯暴力破解的题目，密码的长度一般不会超过 6 位纯数字。可以用 <code>fcrackzip</code>，也可以用 <code>ARCHPR</code>。</p><p><del><em>我个人还是感觉 ARCHPR 好用</em></del></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-掩码">2. 掩码<a href="#2-掩码" class="hash-link" aria-label="2. 掩码的直接链接" title="2. 掩码的直接链接">​</a></h5><p>原理其实和纯暴力大同小异，但是由于知道了部分密码，从而可以选择对密码的特定位置进行枚举爆破。</p><p>例如，对于密码：</p><p>this_it_a_password</p><p>题目可能只会提示：</p><p>this_??_a_pa?????d</p><p>那么问号中的字符就需要选手枚举破解。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="0x03-crc32-爆破">0x03 CRC32 爆破<a href="#0x03-crc32-爆破" class="hash-link" aria-label="0x03 CRC32 爆破的直接链接" title="0x03 CRC32 爆破的直接链接">​</a></h4><p>CRC 本身是「冗余校验码」的意思，全称是循环冗余校验。CRC32 则表示会产生一个 32 bit (8 位十六进制数) 的校验值。由于 CRC32 产生校验值时源数据块的每一个 bit (位) 都参与了计算，所以数据块中即使只有一位发生了变化，也会得到不同的 CRC32 值，利用这个原理我们可以直接爆破出加密文件的内容。由于 CPU 能力，CRC 碰撞只能用于压缩文件较小的情况（≤7bytes）</p><p>常见的题型大致可分为两种：一是只给出含有一个文件的压缩包；二是给出多个含有一个文件的压缩包，或给出一个含有多个文件的压缩包</p><p>值得注意的是 ，zip 中的 CRC32 是未加密文件的校验值。也就意味着可以对小文件直接进行 CRC32 碰撞，从而得到文件的真实内容。这也就导致了基于 CRC32 爆破 的攻击手法。（也就是说 rar 和 7z 没有这种姿势）</p><p>以下为 CRC32 爆破的特征</p><ul><li>文件内内容很少 (一般比赛中大多为 4 字节左右)</li><li>加密的密码很长，几乎不能直接暴力破解</li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="crc32-爆破---例题">CRC32 爆破 - 例题<a href="#crc32-爆破---例题" class="hash-link" aria-label="CRC32 爆破 - 例题的直接链接" title="CRC32 爆破 - 例题的直接链接">​</a></h5><p><a href="https://buuoj.cn/challenges#zip" target="_blank" rel="noopener noreferrer">BUUCTF-zip</a></p><p>附件下载解压，得到了一堆压缩包：</p><p><img loading="lazy" alt="CRC32 files" src="/assets/images/image_20230802-230217-105cac1900a3c09bb386d29081e63e52.png" width="1684" height="774" class="img_ev3q"></p><p>尝试纯暴力破解，发现不行，看一下文件大小，发现文件数据仅仅 4b，可以断定是 CRC32 爆破：</p><p><img loading="lazy" alt="CRC32 single file" src="/assets/images/image_20230802-230241-796cc2ebb85e59e78e45a78e9ba4bad2.png" width="1202" height="789" class="img_ev3q"></p><p>针对单个文件写个 CRC32 碰撞脚本：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> zipfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> binascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CrackCrc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">crc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> k </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> h </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 四个循环对应文件大小为 4b</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    s </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> k </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> crc </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binascii</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">crc32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dic </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ascii_letters </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digits </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;+/=&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;D:\\Downloads\\b2ca8799-13d7-45df-a707-94373bf2800c\\out.txt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;w&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;CRC32begin&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">file</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;D:\\Downloads\\b2ca8799-13d7-45df-a707-94373bf2800c\\&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;out1.zip&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    crc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipfile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ZipFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;r&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getinfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;data.txt&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CRC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CrackCrc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">crc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;CRC32finished&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>再写一个大循环把所有文件批量处理，并且加上进度条：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> zipfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> binascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CrackCrc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">crc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> k </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> h </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    s </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> k </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> crc </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binascii</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">crc32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CrackZip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">68</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">file</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;D:\\Downloads\\b2ca8799-13d7-45df-a707-94373bf2800c\\&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;out&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.zip&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        crc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipfile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ZipFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;r&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getinfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;data.txt&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CRC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CrackCrc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">crc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;\r&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;loading：{:%}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">68</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dic </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ascii_letters </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digits </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;+/=&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;D:\\Downloads\\b2ca8799-13d7-45df-a707-94373bf2800c\\out.txt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;w&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;CRC32 begin&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CrackZip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;CRC32 finished&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>运行脚本，便可以得到 zip 文件解密后的数据。</p><p>另外，也有现成的 Github 项目：<a href="https://github.com/kmyk/zip-crc-cracker" target="_blank" rel="noopener noreferrer">kmyk / zip-crc-cracker</a></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="自动脚本">自动脚本<a href="#自动脚本" class="hash-link" aria-label="自动脚本的直接链接" title="自动脚本的直接链接">​</a></h5><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> zipfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> binascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CrackCrc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">crc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> k </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> h </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 循环个数取决于 CRC32 破解的目标文件大小</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    s </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> k </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> crc </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binascii</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">crc32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dic </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ascii_letters </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digits </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;+/=&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;out.txt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;w&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;CRC32begin&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">file</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;res.zip&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    crc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipfile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ZipFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;r&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getinfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;data.txt&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CRC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CrackCrc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">crc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;CRC32finished&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>另外，还有针对多文件的 CRC32 碰撞脚本：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> zipfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> binascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dic </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">printable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CrackCrc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">crc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> p </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                s </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> p  </span><span class="token comment" style="color:#999988;font-style:italic"># 3bytesCRC32 碰撞</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> crc </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binascii</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">crc32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CrackZip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">36</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">file</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;flag&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.zip&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        f </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipfile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ZipFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;r&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 文件名</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GetCrc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getinfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;flag.txt&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        crc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GetCrc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CRC  </span><span class="token comment" style="color:#999988;font-style:italic"># 提取文件 CRC 值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CrackCrc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">crc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;out.txt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;w&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f_</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CrackZip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f_</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="0x04-明文攻击">0x04 明文攻击<a href="#0x04-明文攻击" class="hash-link" aria-label="0x04 明文攻击的直接链接" title="0x04 明文攻击的直接链接">​</a></h4><p>明文攻击类似于 CRC32 破解，但是明文攻击针对的是较大的文件（至少不能 CRC32 碰撞），并且已知其中一个文件的真实内容。明文攻击是一种较为高效的攻击手段，当我们为 ZIP 压缩文件设定密码时，先被转换成了 3 个 4 字节 key，再使用这 3 个 key 加密所有文件。当能拿到加密压缩包的一个文件时，以同样的方式压缩（选择相同的压缩算法，确保压缩后明文文件的 CRC32 与加密文件中的一致），此时两个压缩包中明文压缩后的大小会相差 12 字节，使用 APCHPR 进行对比筛选后，就可以获得 key，继而解压加密压缩包。</p><ul><li><p>一个加密的压缩文件</p></li><li><p>知道压缩文件的压缩工具，比如 2345 好压， WinRAR ， 7z，zip 等，可以通过文件属性了解。如果是 Linux 平台，用 zipinfo -v 可以查看一个 zip 包的详细信息，包括加密算法等</p></li><li><p>知道压缩包里某个文件的部分连续内容 (至少 12 字节)</p></li><li><p>明文对应文件的加密算法需要是 <code>ZipCrypto Store</code></p></li></ul><p>如果你已经知道加密文件的部分内容，比如在某个网站上发现了它的 readme.txt 文件，你就可以开始尝试破解了。</p><p>首先，将这个明文文件打包成与加密文件相同格式的包，比如将 readme.txt 打包成 readme.zip ，并且尽量用相同的软件（其实影响不大）。</p><p>打包完成后，需要确认二者采用的压缩算法相同。一个简单的判断方法是用 WinRAR 打开文件，同一个文件压缩后的体积是否相同。如果相同，基本可以说明你用的压缩算法是正确的。如果不同，就尝试另一种压缩算法。</p><p>然后使用 <code>ARCHPR</code> 或者 <code>PKCrack</code> 来进行明文破解</p><p><del><em>我个人还是喜欢用 ARCHPR</em></del></p><p>由于明文攻击的特性，当发现明文攻击预期剩余时间较长时，可尝试在进度条完成一定程度下结束攻击，因为此时可能在攻击过程中就已找到密钥，只是软件还在计算。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="例题">例题<a href="#例题" class="hash-link" aria-label="例题的直接链接" title="例题的直接链接">​</a></h5><p><a href="https://buuoj.cn/challenges#%5BACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020%5D%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB" target="_blank" rel="noopener noreferrer">[ACTF 新生赛 2020] 明文攻击</a></p><p>题目附件打开，提取出两个压缩包，其中一个带有加密，并且其中存放着 flag，对比两个压缩包的文件信息：</p><p><img loading="lazy" alt="plain attack encrypt" src="/assets/images/image_20230807-230715-7e7e5f25c9760995231009adb06ad03f.png" width="1202" height="789" class="img_ev3q"></p><p><img loading="lazy" alt="plain attack uncrypt" src="/assets/images/image_20230808-230806-dc3cdd245c1dcbca4527f42bd5b2b18f.png" width="1202" height="789" class="img_ev3q"></p><p>可以发现未加密的压缩包中的 flag.txt 文件的 CRC32 值与加密的压缩包中的相同，并且两个压缩包的格式相同，于是想到进行明文攻击：</p><p><img loading="lazy" alt="ARCHPR plain attack" src="/assets/images/image_20230809-230905-f445a06ce7c349b0e5e4f8c7f5f0ba13.png" width="579" height="566" class="img_ev3q"></p><p>耐心等待执行完成，便可以得到其中的加密文件。</p><blockquote><p>当时我就没有让它跑完所有计算过程，跑了大概 2 分钟左右就中止了，并且也成功解开了压缩包中的数据</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="0x05-压缩包嵌套">0x05 压缩包嵌套<a href="#0x05-压缩包嵌套" class="hash-link" aria-label="0x05 压缩包嵌套的直接链接" title="0x05 压缩包嵌套的直接链接">​</a></h4><p>这个就简单了，就是一个压缩包里面塞着另外一个压缩包，和俄罗斯套娃一样。可以手动解压，也可以用脚本。</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="压缩包嵌套-例题">压缩包嵌套 例题<a href="#压缩包嵌套-例题" class="hash-link" aria-label="压缩包嵌套 例题的直接链接" title="压缩包嵌套 例题的直接链接">​</a></h5><p><a href="https://buuoj.cn/challenges#%5BMRCTF2020%5D%E5%8D%83%E5%B1%82%E5%A5%97%E8%B7%AF" target="_blank" rel="noopener noreferrer">[MRCTF2020] 千层套路</a></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> zipfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0573&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipfile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ZipFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.zip&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;r&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fz</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">extractall</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pwd</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fz</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filelist</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fz</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="rar-文件">RAR 文件<a href="#rar-文件" class="hash-link" aria-label="RAR 文件的直接链接" title="RAR 文件的直接链接">​</a></h2><p>RAR 是一种专有的文件格式，用于文件的压缩、归档与打包。RAR 的全名是：Roshal Archive（即 “罗谢尔的归档” 之意），其开发者是尤金 · 罗谢尔（Eugene Roshal）。Eugene Roshal 后来公开了解码程序的源代码，但是编码程序仍然是私有的。RAR 因为其独特的压缩算法，基本可以做到无损压缩，而且还能够满足较高的压缩比，同时保证一定的压缩速度。RAR 拥有成熟的加密算法，2.0 版本以后使用 AES 算法来加密，AES 算法的破解难度比较大，在没有密码的情况下只能采取暴力破解的办法，对于数据的安全性有一定的保证。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rar-文件结构">rar 文件结构<a href="#rar-文件结构" class="hash-link" aria-label="rar 文件结构的直接链接" title="rar 文件结构的直接链接">​</a></h3><p>以常用的 WinRAR 制作，老版格式不予介绍。</p><p><del><em>这本来就是商业机密好吧</em></del></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rar">Rar<a href="#rar" class="hash-link" aria-label="Rar的直接链接" title="Rar的直接链接">​</a></h4><p><img loading="lazy" alt="RAR file hex" src="/assets/images/image_20230810-231009-e1512c85de350379407979df699176fe.png" width="1920" height="1042" class="img_ev3q"></p><table><thead><tr><th>HEX 数据</th><th>描述</th><th>010Editor 模板数据</th></tr></thead><tbody><tr><td>52 61 72 21 1A 07 00</td><td>rar 文件头标记，文本为 Rar!</td><td></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="main-block">Main block<a href="#main-block" class="hash-link" aria-label="Main block的直接链接" title="Main block的直接链接">​</a></h4><table><thead><tr><th>HEX 数据</th><th>描述</th><th>010Editor 模板数据</th></tr></thead><tbody><tr><td>33 92 B5 E5</td><td>全部块的 CRC32 值</td><td>uint32 HEAD_CRC</td></tr><tr><td>0A</td><td>块大小</td><td>struct uleb128 HeadSize</td></tr><tr><td>01</td><td>块类型</td><td>struct uleb128 HeadType</td></tr><tr><td>05</td><td>阻止标志</td><td>struct uleb128 HeadFlag</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="file-header">File Header<a href="#file-header" class="hash-link" aria-label="File Header的直接链接" title="File Header的直接链接">​</a></h4><table><thead><tr><th>HEX 数据</th><th>描述</th><th>010Editor 模板数据</th></tr></thead><tbody><tr><td>43 06 35 17</td><td>单独块的 CRC32 值</td><td>uint32 HEAD_CRC</td></tr><tr><td>55</td><td>块大小</td><td>struct uleb128 HeadSize</td></tr><tr><td>02</td><td>块类型</td><td>struct uleb128 HeadType</td></tr><tr><td>03</td><td>阻止标志</td><td>struct uleb128 HeadFlag</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="terminator">Terminator<a href="#terminator" class="hash-link" aria-label="Terminator的直接链接" title="Terminator的直接链接">​</a></h4><table><thead><tr><th>HEX 数据</th><th>描述</th><th>010Editor 模板数据</th></tr></thead><tbody><tr><td>1D 77 56 51</td><td>固定的 CRC32 值</td><td>uint32 HEAD_CRC</td></tr><tr><td>03</td><td>块大小</td><td>struct uleb128 HeadSize</td></tr><tr><td>05</td><td>块类型</td><td>struct uleb128 HeadType</td></tr><tr><td>04 00</td><td>阻止标志</td><td>struct uleb128 HeadFlag</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rar-文件常见考点">rar 文件常见考点<a href="#rar-文件常见考点" class="hash-link" aria-label="rar 文件常见考点的直接链接" title="rar 文件常见考点的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="爆破">爆破<a href="#爆破" class="hash-link" aria-label="爆破的直接链接" title="爆破的直接链接">​</a></h4><p>这个与 zip 相同，要么使用 <code>ARCHPR</code>（个人推荐），或者使用 <code>RarCrack</code>：</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rar-伪加密">rar 伪加密<a href="#rar-伪加密" class="hash-link" aria-label="rar 伪加密的直接链接" title="rar 伪加密的直接链接">​</a></h4><p>使用 010 Editor 运行模板查看加密的 rar 文件信息，可以在每个文件的文件块里面看到加密状态：</p><p><img loading="lazy" alt="Rar file hex encrypt" src="/assets/images/image_20230811-231105-23e6a35fd2ab21526f1d9a1c07a042a5.png" width="1920" height="1042" class="img_ev3q"></p><p><img loading="lazy" alt="Rar file hex encrypt format" src="/assets/images/image_20230811-231125-2c380acbc6ee0f806c9e15216a190e7d.png" width="1429" height="399" class="img_ev3q"></p><p>0 表示没有加密，并且由于 Rar 文件头部自带校验信息，所以伪加密文件在打开的时候会提示文件存在错误，可以尝试使用 Winrar 自带的文件修复来解开伪加密。</p><p>由于 rar 格式是一种商业格式，所以对于其数据结构只是一种合理猜测，对于不同版本的 rar，可能存在不同的数据结构。故届时如发现 rar 文件的数据结构不同于此文档的介绍，请合理使用 010 Editor 的模板功能。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="特殊考点">特殊考点<a href="#特殊考点" class="hash-link" aria-label="特殊考点的直接链接" title="特殊考点的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="连续解压">连续解压<a href="#连续解压" class="hash-link" aria-label="连续解压的直接链接" title="连续解压的直接链接">​</a></h3><p>适用于一个目录下的连续文件名的压缩包的解压：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">519</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;unzip -o {}.zip -d .&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>另外，也可以将目录下所有的 zip 文件进行解压：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> zipfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 压缩包所在位置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zip_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">folder_abs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 解压文件到指定目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">listdir</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> file_name </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> file_list</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> file_name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;zip&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        zip_list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> zip_file_name </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> zip_list</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zip_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipfile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ZipFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\\&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> zip_file_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zip_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zip_file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">namelist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> f </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> zip_list</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        zip_file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">extract</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> folder_abs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zip_file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="zipbomb">Zipbomb<a href="#zipbomb" class="hash-link" aria-label="Zipbomb的直接链接" title="Zipbomb的直接链接">​</a></h3><p>压缩包炸弹，简单来说就是运用压缩算法的特性，做到仅仅几 kb 和仅 mb 的压缩包文件，解压出来 GB，甚至 PB 级的数据。这个时候，就不能简单使用传统方法，先解压再分析，而是直接对压缩包的数据进行分析。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="zipbomb-例题">Zipbomb 例题<a href="#zipbomb-例题" class="hash-link" aria-label="Zipbomb 例题的直接链接" title="Zipbomb 例题的直接链接">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="nssctf-新生赛---misc-zipbomb"><a href="https://www.ctfer.vip/#/contest/5/" target="_blank" rel="noopener noreferrer">NSSCTF 新生赛 - Misc-zipbomb</a><a href="#nssctf-新生赛---misc-zipbomb" class="hash-link" aria-label="nssctf-新生赛---misc-zipbomb的直接链接" title="nssctf-新生赛---misc-zipbomb的直接链接">​</a></h5><p>可以看到压缩包中全是炸弹：</p><p><img loading="lazy" alt="zip bomb files 1" src="/assets/images/image_20230811-231159-629986f40b49a7f778ae6c37ce446b22.png" width="1920" height="873" class="img_ev3q"></p><p>这个时候如果用<code>binwalk</code>进行分析，也是会触发压缩包炸弹，于是选择直接用010 Editor进行数据搜索：</p><p><img loading="lazy" alt="zip bomb files 1 format" src="/assets/images/image_20230812-231226-74b0c98b79376ffb1b67ce3d90ee5ad4.png" width="1920" height="1013" class="img_ev3q"></p><p>可以看到存在附加数据，手动对HEX数据进行分离，即可打开附加的压缩包：</p><p><img loading="lazy" alt="zip bomb files 1 extra" src="/assets/images/image_20230812-231251-c2ccde5a9244289cefc7a6faa30d7a6c.png" width="1920" height="1013" class="img_ev3q"></p><p><img loading="lazy" alt="zip bomb files 1 extra file" src="/assets/images/image_20230813-231309-67d7b892260c632028d3b156040e43c8.png" width="1202" height="789" class="img_ev3q"></p><p>这时候即可放心解压，得到以下数据：</p><p><img loading="lazy" alt="zip bomb files 1 unzip data" src="data:image/png;base64,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" width="922" height="52" class="img_ev3q"></p><p>正则匹配，即可出来flag：</p><p><img loading="lazy" alt="zip bomb files 1 flag" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATkAAAD5CAIAAADTHNWmAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAA6mSURBVHhe7d0xTBvJHsfxea91ESnoJHRSrsCvONFQIapIDo0luoBSXG9XhC6itdyi64AK+isQpLNEA5auQlQ0KMVBE+kUKSIShfs3Mzvrnd21F+8Au/fnvp8mAWPjtf3bmR17f/znl19+UTPp7A7Wm7cnax8P7Zet/h+bi6rRUJc7v/VU72jj7w9bB/YSw/7wvbloqL/YO3pz8qF35i5Tq/2jT8uN8U1FX6qbk7Wt6Kb1d3bfnm/19VVj3d3B+/nL370b0ewVv31e834v8GL91/1b2vD8i2q8ir/of7haGnjW5y921mxQtcOP+6rrLjBswOLMK3XW+7C2c3nfXHcXDwZddewHFYBSs4+rAOoUPK4CqBRZBWQgq4AMZBWQgawCMpBVQAayCshAVgEZyCogA1kFZCCrgAwlz7NR6sY7r6WzN1ifcyfTuC8X7P+05IycSKv/x/Zy/Fn/0cXOh/Sn81PXdSfopK6SEt24O0Enxb97wEtSMqv3o5G63vfD6bIa5co7r627e/TzcRzI1ClyWit1Dl20F+CcOKBIyTnw3fW1Wny36r5KdDf0AHjzOQ6bdrA1HjlbvXZTjS4PXFC1YT852bWzlw6qdtZLBRVA+ePVr+df1PJ6x32VNv9zy/1vgsZrPYGeoLOkp763V/50GUBe6bWlYf/0ZmEpG9aD48t71VjZHgyO+rlR11xFqeb7wWCwm71id8kcAxNV4CEB68CHxxfz7V5mCB32fltb+6wj2Vj+ZKodjlI/cLi1trZzMdKBjcofdrvugsezu4Cx3L4AeClC3rMZ/nmtVjYmpOJAR1LbcWPsH30/r/oY1V564sbYvaeJ1c1ne6uOd9ALvCwhWVVnvdPb5tLUsdGMsWYUfbW8MeFnzBh7cqvUQtvMlm9+mNE2N6cGkBGUVR24q5unCdjZ+fW9zi1hBR4QmFWzmDTXbs+5r1q9o/QhaGdjpaHuL4/tGzOdvfSC02q/bdZ+T+2bpcPeweXIHMd6h5qr/d3s8TDwbxeaVTpHgWrROQrIEDyuAqgUWQVkIKuADGQVkIGsAjKQVUAGsgrIQFYBGcgqIANZBWQgq4AMZBWQgX5gQAb6gQEZSs6B6QcGalL2eJV+YKAepdeW6AcGahGwDkw/MFCDkPds6AcGqheSVfqBgeoFZZV+YKBygVmlHxioWGhW6QcGqkU/MCBD8LgKoFJkFZCBrAIykFVABrIKyEBWARnIKiADWQVkIKuADGQVkIGsAjKQVUAG+oEBGegHBmQoOQemHxioSdnjVfqBgXqUXluiHxioRcA6MP3AQA1C3rOhHxioXkhW6QcGqheUVfqBgcoFZpV+YKBioVmlHxioFv3AgAzB4yqASpFVQAayCshAVgEZyCogA1kFZCCrgAxkFZCBrAIykFVABrIKyEBWARnoBwZkoB8YkKHkHJh+YKAmZY9X6QcG6lF6bYl+YKAWAevA9AMDNQh5z4Z+YKB6IVmlHxioXlBW6QcGKheYVfqBgYqFZpV+YKBa9AMDMgSPqwAqRVYBGcgqIANZBWQgq4AMZBWQgawCMpBVQAayCshAVgEZyCogA52jgAx0jgIylJwD0zkK1KTs8Sqdo0A9Sq8t0TkK1CJgHZjOUaAGIe/Z0DkKVC8kq3SOAtULyiqdo0DlArNK5yhQsdCs0jkKVIvOUUCG4HEVQKXIKiADWQVkIKuADGQVkIGsAjKQVUAGsgrIQFYBGcgqIEPYZwzjhkGv7gw59lG6y/Q5yuDXSuarIeNL0y1ZeGYh42pnb3tZXe6srY0/nY8X5vCjPXX/98uR+0ZKdOnJbfrsKDyzgHHVVISqzL7WdILmu89G6ZZQNxrny4HDpCqFjcyvc6WkcYFwdhDwr/5Udylt0rjqHqgnHZEKN/NRiltdzaWL1/5j7u6J/0RkH4TUs5YpkU5tSO7ZzFzXzemiwtoJ3HOauk1HaIl0+XF19c28+5/HtbeMmRqX+AxVo9U7Ggw21dnk/XQ4/YS536h3843lT96JsjoVn5bVRXR5dM7deBDQLyD9rOuXtfX5prGynS6Ieg76VTUYLF2ZTownVLSZFZhQTzm6n9Z0mX7Ytaul5GFPbYi2r7/j3Yp59FLXPVAb5rqmZiRiC72SH/B3vumiH6mF0s+yttTqbZpe7/Eus7u7/ev1ztqH3o37hk/vLE33kt7/RSevhjanHZ7oHcH4pdPqrzb1bjt+woa9305uVNNVupk2Y73bjsefgy39NDeiBilzN3Tgba5sJ6O5e1q6O6qA+3nD/6MB+mVqJiMFx652dxbzyqjM981vj+6S4e1WCjfT8u5PprAu2tixCQWUgb5cT2i61IpKpO2G3F/uJwHT25L8JCXS2jNkdbW/udLIPCUPHNkurA/MbMrs83Rsmu8f/bpZfbeoXxZelantE1eNX9/pV2tnSb8srs+T+ZVtsVBJg9Rit/3jdz1GNRa7R+vqxPQzvprUYJ5lx4258VBvJxeO6aAq2J3rQG6vqEv7CJhrfm+ndlivlrftcYdhZwHu0sLN1OykMRlqTn/a9B7Yjr6RfXdJblbyKOdXt6n9ha+oRPrV6/+5/2VQIm08fVY768uNe9feMrPk4MSWCTcW305/Ridr9bve722+1kdNP+JhXL9k9cB+Yura9Kuh9WZOqbuvbt9hxhYdA9OuGL+MGo07N3tvvPoWzw6mdZF7ouHa+/MCs/vfTw1/9+H/XYJIcohlq5hd2VXRZmp2S72X+OFH/wjwcMvbgUazknIP+9nXb+5/WfrWVLy/SBSVSA97Z6bf0nSD5AsuKZG2Sme19XaxoR+3aVHs7q4vlH+9pka5v37oZ/SnKXvYDDPgROxf05kwepupY/u7KZT5y30nYaaXn16f5g5gkpfF/Y/8tabJDdcl/PXd1D5uT51p+w/48OudUnNv0j85cTPtT+o5yyz1rtODN515ppqrk+7zWe/0Lt9iaSYXU0ukzZKHnYnoO2w85VH3yyiRLpHV6IBq08ybvPltSmf3fXN0sZ9ZvntG3trSzsW8fpJTU8dmNGamlhnGolFo5wlXTR/BlCebmXa86ylVnjx9Mw8/2hUX9+rPHq+mjpCnrKYWstk7e23uc24vY5ouJ8a4qETa3qBm8mzG2LCVi7yXUSJdIqtRGfe+2py2Z7IHSzenNR3xD/v7ZnIYvT5M7XBj+b05Bh6PmXaeqcdJN9qYA9HxOGwXt7/9Xc89d+K1dFuePNtgWLSZTlyh7rIxjqs9Qm54L2JzFFCSOT4fLF2Za+dnNHrGO/HPlDkmllNLpM1DYTvfk2eTEunyc+Dhn9cjbxkmkV9SCpNbLyknOhCNaoe9N43MFHVBjb6c60v1Lt8cIZ8kv+KBif1s7DzWWx2xy54B9GBo4pqd5Y4lG1K8mWk6Gzau7uCi9e7XpBQ20APPlGm6XHw727FMMUqkrSdbWwpaUspLLxGVYd8oGr907FrFwno8iTJvmTTHbwmYRY7GcjeefXV37Qjz2L1MtBdz65+r/aP386NkHbiYvnup9xLNsud49SstevcinrwUbqY+JPFnmDZao+/RiGsnF+PFbbvAVn4O/IBh//TbSnvRfWVG8vSc1i+RTt9V88NmQfvmLBquKZE2yn9uST+v+c+yTP7cUrx6aa+S+ezIeO3Xvq/gvmVk/yD6VNkr5j+y49+r7EeX9cs6ef8zWWVNts7+gLLXsreT/EyB5DeaO6P0PdQzbbs5uXtrJRvb8T9/43+OKpqsRv838p/BLtjM9COf3gT/EdD39mrJtjrb35u6M7Hcw5t/JdjvKO/Ou62ONzPzIKQ+LpZ9keR+Xfopyz8O9oH69vCdFOuJsvoI5vlzfxwdE0x+Cf4TvKAYiFB+DhyyuA/gsQKOV6e/q4Z/E7NC8egFOcyu/vNXp82Bs8dpaTMdPT6puu7PP3AOHB92TjgVBs8nLKsAqvZk79kAeFZkFZCBrAIykFVABrIKyEBWARnIKiADWQVkmP2zEO7cC/8DOpmPHKXOosieLpM6SSLfx5u6rvs4VPq8Cl9049kzM4zqP88EVKNkVu9HI3W974fTZTXKlXceU3f36OfjOJDRdZNUt3pHG3+P67+ivYB33dX+7tvzVKOkOe1rPvuJNs7zwL9JyTnw3fX1xGKOoupXncx2U6UK0/yePqpfgVmUPV79ev5lWqt6YfXr1M5Oql+BmZReWzL9vfnmm6LqV3sVFfU+5krVqH4FZhOwDnx4fDGfa1UvrH61f3TE/rkRW9b8dF2S2suofgUeFPKezfDPaxX99ZeMourXcfml7ZLUAStVgTvdzYuofgUeFJJV06p+O6l21CmsfrVjrK3AbZvZMtWvwGyCsmordp8mYFS/ArMJzKpZTJprt+fcV62i6lfV2UsvOK3222btN2qgpvoVmEloVm2reiP+UJE+Fr1acss7lmmaHf/dhMOP+6rrLjDsBxiSTzWd9T6YQ1y37GR01THvrwJp9C0BMgSPqwAqRVYBGcgqIANZBWQgq4AMZBWQgawCMpBVQAayCshAVgEZyCogA1kFZKAfGJCBfmBAhpJzYPqBgZqUPV6lHxioR+m1JfqBgVoErAPTDwzUIOQ9G/qBgeqFZJV+YKB6QVmlHxioXGBW6QcGKhaaVfqBgWrRDwzIEDyuAqgUWQVkIKuADGQVkIGsAjKQVUAGsgrIQFYBGcgqIANZBWQgq4AMZBWQgX5gQAb6gQEZSs6B6QcGalL2eJV+YKAepdeW6AcGahGwDkw/MFCDkPds6AcGqheSVfqBgeoFZZV+YKBygVmlHxioWGhW6QcGqkU/MCBD8LgKoFJkFZCBrAIykFVABrIKyEBWARnIKiADWQVkIKuADGQVkIGsAjLQOQrIQOcoIEPJOTCdo0BNyh6v0jkK1KP02hKdo0AtAtaB6RwFahDyng2do0D1QrJK5yhQvaCs0jkKVC4wq3SOAhULzSqdo0C16BwFZAgeVwFUiqwCMpBVQAayCshAVgEZyCogA1kFZCCrgAxkFZBAqf8DWQQyP2eR2WYAAAAASUVORK5CYII=" width="313" height="249" class="img_ev3q"></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="dasctf-九月赛-zipbomb"><a href="https://buuoj.cn/match/matches/36/challenges#ZipBomb" target="_blank" rel="noopener noreferrer">DASCTF 九月赛-ZipBomb</a><a href="#dasctf-九月赛-zipbomb" class="hash-link" aria-label="dasctf-九月赛-zipbomb的直接链接" title="dasctf-九月赛-zipbomb的直接链接">​</a></h5><p>作为第一层压缩包，附件还是可以正常打开的：</p><p><img loading="lazy" alt="zip bomb files 2 files" src="/assets/images/image_20230814-231409-ac0a58b3141c028af41d821fda7f4c92.png" width="1684" height="774" class="img_ev3q"></p><p>面对大量的压缩包炸弹，只能使用脚本分析文件特征：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> zipfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dir_path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;C:\\Users\\Snowywar\\Desktop\\zipBomb&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">files </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">listdir</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dir_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">newfiles </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> files</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">newfiles</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setee </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token builtin">file</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> newfiles</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 遍历文件夹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    position </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dir_path </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\\&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">file</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 构造绝对路径，&quot;\\&quot;，其中一个&#x27;\&#x27;为转义符</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">position</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    z </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> zipfile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ZipFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">position</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;r&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> filename </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> z</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">namelist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">bytes</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> z</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&#x27;Zmxh&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">bytes</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&#x27;flag&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">bytes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在这里，<code>Zmxh</code>是flag的Base64编码后的结果，针对flagBase64编码后的数据做特征识别，而flag则是直接识别flag。运行后即可找到flag存在于哪个压缩包和压缩包中的哪个文件。打开文件：</p><p><img loading="lazy" alt="zip bomb files 2 flag base64" src="/assets/images/image_20230814-231445-595adf78a764658382c7cf1e9ced5b1e.png" width="1920" height="1013" class="img_ev3q"></p><p>Base64解码，即可得到flag：</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b64decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b&quot;ZmxhZ3tGIW5EX0ZsNGdfMW5fMklQXzEzT01CfQ==&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> flag</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">F!nD_Fl4g_1n_2IP_13OMB</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="扩展型zip明文攻击">扩展型ZIP明文攻击<a href="#扩展型zip明文攻击" class="hash-link" aria-label="扩展型ZIP明文攻击的直接链接" title="扩展型ZIP明文攻击的直接链接">​</a></h3><blockquote><p>这一块详情请见：<a href="https://blog.csdn.net/q851579181q/article/details/109767425" target="_blank" rel="noopener noreferrer">ZIP已知明文攻击深入利用</a></p><p>这种攻击太暴力了，怀疑实战中成功的概率太小了</p></blockquote><p>此攻击方法并不需要知道压缩文件中完整的明文，只需在已知加密压缩包中的少部分明文字节时即可进行攻击破解。而各类文件都有其自身固定的文件格式，结合这类格式，极大扩展了ZIP明文攻击的攻击面。</p><p>具体要求如下：</p><ul><li>至少已知明文的12个字节及偏移，其中至少8字节需要连续。</li><li>明文文件需要被相同的压缩算法标准压缩（也可理解为被相同压缩工具压缩）</li><li>明文对应的文件加密方式为<code>ZipCrypto Store</code></li></ul><p>可以说此方法大大提高了Zip明文攻击的适用范围，同时也是一种<strong>全新的非预期解的实现方式</strong></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="涉及到的工具">涉及到的工具<a href="#涉及到的工具" class="hash-link" aria-label="涉及到的工具的直接链接" title="涉及到的工具的直接链接">​</a></h4><p><a href="https://github.com/kimci86/bkcrack" target="_blank" rel="noopener noreferrer"><strong>bkcrack：</strong></a></p><blockquote><p><strong>bkcrack常用参数：</strong></p><ul><li>-c 提取的密文部分</li><li>-p 提取的明文部分</li><li>-x 压缩包内目标文件的偏移地址  部分已知明文值</li><li>-C 加密压缩包</li><li>-o offset  -p参数指定的明文在压缩包内目标文件的偏移量</li></ul></blockquote><p>基本可以说，只要满足了已知文件头和文件名，以及内部的少量数据，就可以以此为数据进行明文攻击</p><p><del>仅适用于小的Zip文件</del></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Randark-JMT/Treasure-House/edit/main/docs/CTF-Research/Archives/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/CTF-Research/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">CTF研究</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/CTF-Research/Archives/ZIP-Bomb"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">zip 压缩包炸弹</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#zip-文件" class="table-of-contents__link toc-highlight">ZIP 文件</a><ul><li><a href="#zip-文件结构" class="table-of-contents__link toc-highlight">zip 文件结构</a></li><li><a href="#zip-文件常见考点" class="table-of-contents__link toc-highlight">zip 文件常见考点</a></li></ul></li><li><a href="#rar-文件" class="table-of-contents__link toc-highlight">RAR 文件</a><ul><li><a href="#rar-文件结构" class="table-of-contents__link toc-highlight">rar 文件结构</a></li><li><a href="#rar-文件常见考点" class="table-of-contents__link toc-highlight">rar 文件常见考点</a></li></ul></li><li><a href="#特殊考点" class="table-of-contents__link toc-highlight">特殊考点</a><ul><li><a href="#连续解压" class="table-of-contents__link toc-highlight">连续解压</a></li><li><a href="#zipbomb" class="table-of-contents__link toc-highlight">Zipbomb</a></li><li><a href="#扩展型zip明文攻击" class="table-of-contents__link toc-highlight">扩展型ZIP明文攻击</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">社交联系</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Randark-JMT" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/Randark_JMT" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:randark@foxmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foxmail mail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:randarkjmt@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google mail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">相关项目友链</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/CTF-Archives" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - CTF-Archives<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/CTF-Archives/ctf-docker-template" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub - ctf-docker-template<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/ProbiusOfficial/CTF-QuickStart" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub - CTF-QuickStart<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://blog.probius.xyz/" target="_blank" rel="noopener noreferrer" class="footer__link-item">探姬の星灵枢纽<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="http://www.snowywar.top" target="_blank" rel="noopener noreferrer" class="footer__link-item">雪殇 - snowywar.top<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Treasure-House By Randark-JMT, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.98fc27d7.js"></script>
<script src="/assets/js/main.c88a2240.js"></script>
</body>
</html>