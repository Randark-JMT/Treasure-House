<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Forensic/Memory-Forensic/Volatility/Volatility-intro" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Volatility 使用入门 | Randark_JMT - 陈橘墨</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="http://treasure-house.randark.site/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="http://treasure-house.randark.site/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="http://treasure-house.randark.site/docs/Forensic/Memory-Forensic/Volatility/Volatility-intro"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Volatility 使用入门 | Randark_JMT - 陈橘墨"><meta data-rh="true" name="description" content="本篇展示操作时所用的检材来自于 OtterCTF 2018 比赛的附件：[OtterCTF 2018]What the password?"><meta data-rh="true" property="og:description" content="本篇展示操作时所用的检材来自于 OtterCTF 2018 比赛的附件：[OtterCTF 2018]What the password?"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="http://treasure-house.randark.site/docs/Forensic/Memory-Forensic/Volatility/Volatility-intro"><link data-rh="true" rel="alternate" href="http://treasure-house.randark.site/docs/Forensic/Memory-Forensic/Volatility/Volatility-intro" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="http://treasure-house.randark.site/docs/Forensic/Memory-Forensic/Volatility/Volatility-intro" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Randark_JMT - 陈橘墨 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Randark_JMT - 陈橘墨 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.2e9ebd3e.css">
<script src="/assets/js/runtime~main.bdf4c183.js" defer="defer"></script>
<script src="/assets/js/main.896c1523.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.jpg" alt="Randark_JMT" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.jpg" alt="Randark_JMT" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Treasure-House</b></a><a class="navbar__item navbar__link" href="/docs/Environment/">环境配置</a><a class="navbar__item navbar__link" href="/docs/Devops/">开发部署</a><a class="navbar__item navbar__link" href="/docs/Penetration/">渗透测试</a><a class="navbar__item navbar__link" href="/docs/Attack-Defense/">红蓝攻防</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Forensic/">电子取证</a><a class="navbar__item navbar__link" href="/docs/ICS/">工业控制</a><a class="navbar__item navbar__link" href="/docs/CTF-Research/">CTF研究</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://randark.site/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">主站<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/Randark-JMT" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item green"><a class="menu__link" href="/docs/Forensic/">电子取证</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item green"><a class="menu__link" href="/docs/Forensic/Sample-Types">检材类型</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/Forensic/Memory-Forensic/">内存取证</a><button aria-label="折叠侧边栏分类 &#x27;内存取证&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Forensic/Memory-Forensic/Linux/">Linux 内存镜像分析</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/Forensic/Memory-Forensic/Make-Image/">如何制作内存镜像</a><button aria-label="展开侧边栏分类 &#x27;如何制作内存镜像&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Forensic/Memory-Forensic/MemProcFS/">MemProcFS 指南</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Forensic/Memory-Forensic/Volatility/">Volatility 指南</a><button aria-label="折叠侧边栏分类 &#x27;Volatility 指南&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/Forensic/Memory-Forensic/Volatility/Volatility-installation">Volatility 如何安装</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item green"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Forensic/Memory-Forensic/Volatility/Volatility-intro">Volatility 使用入门</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/Forensic/Memory-Forensic/Volatility/Volatility-plugin">Volatility 插件指南</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Forensic/SSH-Traffic-Analysis/">SSH 流量分析解密</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Forensic/Traffic-Forensic/">流量分析</a><button aria-label="展开侧边栏分类 &#x27;流量分析&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/Forensic/Memory-Forensic/"><span itemprop="name">内存取证</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/Forensic/Memory-Forensic/Volatility/"><span itemprop="name">Volatility 指南</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Volatility 使用入门</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>Volatility 使用入门</h1>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_BuS1"><p>本篇展示操作时所用的检材来自于 OtterCTF 2018 比赛的附件：<a href="https://www.ctfer.vip/problem/2458" target="_blank" rel="noopener noreferrer">[OtterCTF 2018]What the password?</a></p><p>所使用的 Volatility 2 环境是直接由源码运行，Volatility 3 环境由 pip 安装得来</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="volatility-2-工作流">Volatility 2 工作流<a href="#volatility-2-工作流" class="hash-link" aria-label="Volatility 2 工作流的直接链接" title="Volatility 2 工作流的直接链接">​</a></h2>
<p>简单来讲，就是需要先识别出是何种内存镜像，取自何种系统，然后指定符号表并加载模块进行数据分析</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_BuS1"><p>Volatility 在使用模块的时候（非 imageinfo 这类通用型），需要指定符号表（<code>--profile</code> 参数）才可以正常工作</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="分析检材类型">分析检材类型<a href="#分析检材类型" class="hash-link" aria-label="分析检材类型的直接链接" title="分析检材类型的直接链接">​</a></h3>
<p>拿到检材后的第一件事，便是识别出检材的类型，已经提取自何种设备，所使用的模块是 <code>imageinfo</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ python2 ./volatility2/vol.py -f ./OtterCTF.vmem imageinfo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Volatility Foundation Volatility Framework 2.6.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     AS Layer2 : FileAddressSpace (/home/randark/OtterCTF.vmem)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                      PAE type : No PAE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           DTB : 0x187000L</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                          KDBG : 0xf80002c430a0L</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          Number of Processors : 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     Image Type (Service Pack) : 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                KPCR for CPU 0 : 0xfffff80002c44d00L</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                KPCR for CPU 1 : 0xfffff880009ef000L</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             KUSER_SHARED_DATA : 0xfffff78000000000L</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           Image date and time : 2018-08-04 19:34:22 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     Image local date and time : 2018-08-04 22:34:22 +0300</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里就可以看到，Volatility 成功识别出了目标设备的内存数据类型（提取自 Windows 系统），并且给出了系统版本的建议：<code>Win7SP1x64</code></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_BuS1"><p>对于非 WIndows 系统的设备提取出来的内存镜像，Volatility 无法正确识别出设备的内存情况，这个时候需要使用 strings+grep 直接对内存镜像中的数据进行筛选，通过关键字判断内存提取自何种设备</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="查看进程列表">查看进程列表<a href="#查看进程列表" class="hash-link" aria-label="查看进程列表的直接链接" title="查看进程列表的直接链接">​</a></h3>
<p>接下来就可通过 <code>pslist</code> 模块来查看目标设备在提取内存镜像的时候，都运行哪些进程：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ python2 ./volatility2/vol.py -f OtterCTF.vmem --profile=Win7SP1x64 pslist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Volatility Foundation Volatility Framework 2.6.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Offset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa8018d44740 System                    4      0     95      411 ------      0 2018-08-04 19:26:03 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801947e4d0 smss.exe                260      4      2       30 ------      0 2018-08-04 19:26:03 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801a0c8380 csrss.exe               348    336      9      563      0      0 2018-08-04 19:26:10 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa80198d3b30 csrss.exe               388    380     11      460      1      0 2018-08-04 19:26:11 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801a2ed060 wininit.exe             396    336      3       78      0      0 2018-08-04 19:26:11 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801aaf4060 winlogon.exe            432    380      3      113      1      0 2018-08-04 19:26:11 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801ab377c0 services.exe            492    396     11      242      0      0 2018-08-04 19:26:12 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801ab3f060 lsass.exe               500    396      7      610      0      0 2018-08-04 19:26:12 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801ab461a0 lsm.exe                 508    396     10      148      0      0 2018-08-04 19:26:12 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa8018e3c890 svchost.exe             604    492     11      376      0      0 2018-08-04 19:26:16 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801abbdb30 vmacthlp.exe            668    492      3       56      0      0 2018-08-04 19:26:16 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801abebb30 svchost.exe             712    492      8      301      0      0 2018-08-04 19:26:17 UTC+0000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">......</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="查看内存中加载了哪些文件">查看内存中加载了哪些文件<a href="#查看内存中加载了哪些文件" class="hash-link" aria-label="查看内存中加载了哪些文件的直接链接" title="查看内存中加载了哪些文件的直接链接">​</a></h3>
<p>在系统打开文件的时候，文件数据就会被从磁盘中加载到内存中，这便在便在内存中留下了文件数据。所使用的模块是 <code>filescan</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ python2 ./volatility2/vol.py -f OtterCTF.vmem --profile=Win7SP1x64 filescan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Volatility Foundation Volatility Framework 2.6.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Offset(P)            #Ptr   #Hnd Access Name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">------------------ ------ ------ ------ ----</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x0000000005def290      6      0 RW-rwd \Device\HarddiskVolume1\$Directory</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x0000000005df67f0      1      1 R--rw- \Device\HarddiskVolume1\Windows\System32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d402680     14      0 R--r-d \Device\HarddiskVolume1\Nexon\MapleStory\l3codeca.acm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d405270      1      1 R--r-- \Device\HarddiskVolume1\Users\Rick\AppData\Roaming\BitTorrent\dlimagecache\165F6EF40A81DD175FFAEA69E77ABFD30B27E71C</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d405d20      1      0 R--r-- \Device\HarddiskVolume1\Windows\System32\config\systemprofile\AppData\LocalLow\Microsoft\CryptnetUrlCache\MetaData\DDA81A73291E20E6ACF6CACA76D5C942_4D9486FF3A1DA70CF6B67432FCEC9330</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d406510     16      0 R--r-d \Device\HarddiskVolume1\Windows\assembly\NativeImages_v2.0.50727_32\SMDiagnostics\8218dc4808b77f3585fb048c61597af1\SMDiagnostics.ni.dll</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d413930      1      0 R--r-- \Device\HarddiskVolume1\Windows\Microsoft.NET\Framework64\v2.0.50727\CONFIG\machine.config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d414dc0      1      1 R--r-d \Device\HarddiskVolume1\Windows\System32\en-US\setupapi.dll.mui</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d418290     16      0 RWDr-- \Device\HarddiskVolume1\Windows\System32\Tasks\Microsoft\Windows Defender\MP Scheduled Scan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d418f20      9      0 R--r-d \Device\HarddiskVolume1\Windows\SysWOW64\dinput8.dll</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d42b7b0      1      1 ------ \Device\Afd\Endpoint</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">......</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p>filescan 所输出的数据量是十分庞大的，所以想要增加效率的话，可以使用 grep + 关键词来对数据进行筛选。关键词可以使用例如 Desktop，桌面（中文用户的桌面路径），secret，hint，flag 等等。</p><p>同时需要注意的是，使用 grep 对结果进行筛选的时候，关键词是有大小写敏感的</p><p>filescan 输出的结果中，传统的盘符（如 C 盘，D 盘）并不能正确显示，取而代之的则是如 <code>Device\HarddiskVolume1\</code> 这类的表示方法</p></div></div>
<p>使用 grep + 关键词的效果如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ python2 ./volatility2/vol.py -f OtterCTF.vmem --profile=Win7SP1x64 filescan | grep Desktop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Volatility Foundation Volatility Framework 2.6.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d660500      2      0 -W-r-- \Device\HarddiskVolume1\Users\Rick\Desktop\READ_IT.txt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d74c2d0      2      1 R--rwd \Device\HarddiskVolume1\Users\Rick\Desktop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d7f98c0      2      1 R--rwd \Device\HarddiskVolume1\Users\Rick\Desktop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d864250     16      0 R--rwd \Device\HarddiskVolume1\Users\Public\Desktop\desktop.ini</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d8a9070     16      0 R--rwd \Device\HarddiskVolume1\Users\Rick\Desktop\desktop.ini</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d8ac800      2      1 R--rwd \Device\HarddiskVolume1\Users\Public\Desktop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d8ac950      2      1 R--rwd \Device\HarddiskVolume1\Users\Public\Desktop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007e410890     16      0 R--r-- \Device\HarddiskVolume1\Users\Rick\Desktop\Flag.txt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007e5c52d0      3      0 R--rwd \Device\HarddiskVolume1\Users\Rick\AppData\Roaming\Microsoft\Windows\SendTo\Desktop.ini</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007e77fb60      1      1 R--rw- \Device\HarddiskVolume1\Users\Rick\Desktop</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="根据-filescan-的结果提取内存中的文件">根据 filescan 的结果提取内存中的文件<a href="#根据-filescan-的结果提取内存中的文件" class="hash-link" aria-label="根据 filescan 的结果提取内存中的文件的直接链接" title="根据 filescan 的结果提取内存中的文件的直接链接">​</a></h3>
<p>如上文，在内存数据中发现了一个明显可疑的文件：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x000000007d660500      2      0 -W-r-- \Device\HarddiskVolume1\Users\Rick\Desktop\READ_IT.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>那么就可以使用 <code>dumpfiles</code> 模块将其的数据提取出来：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ python2 ./volatility2/vol.py -f OtterCTF.vmem --profile=Win7SP1x64 dumpfiles -Q 0x000000007d660500 -D ./</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Volatility Foundation Volatility Framework 2.6.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DataSectionObject 0x7d660500   None   \Device\HarddiskVolume1\Users\Rick\Desktop\READ_IT.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>提取出来的文件名为：<code>file.None.&lt;PHYSOFFSET&gt;.dat</code></p>
<p>那么就可以浏览目标文件的数据了：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ cat file.None.0xfffffa801b2def10.dat</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Your files have been encrypted.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Read the Program for more information</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">read program for more information.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="根据-pslist-的结果提取程序其可寻址的内存数据">根据 pslist 的结果提取程序其可寻址的内存数据<a href="#根据-pslist-的结果提取程序其可寻址的内存数据" class="hash-link" aria-label="根据 pslist 的结果提取程序其可寻址的内存数据的直接链接" title="根据 pslist 的结果提取程序其可寻址的内存数据的直接链接">​</a></h3>
<p>在上文的 pslist 结果中，可以发现一个可疑程序：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801b486b30 Rick And Morty         3820   2728      4      185      1      1 2018-08-04 19:32:55 UTC+0000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>那么就可以使用 memdump 模块将程序的可寻址的内存数据提取出来，并对数据进行分析，查看程序都加载并操作了哪些数据：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ python2 ./volatility2/vol.py -f OtterCTF.vmem --profile=Win7SP1x64 memdump -p 3820 -D ./</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Volatility Foundation Volatility Framework 2.6.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">************************************************************************</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Writing Rick And Morty [3820] to 3820.dmp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>输出的文件名格式为：<code>&lt;pid of process&gt;.dmp</code></p>
<p>然后就可以利用 <code>strings</code> 对提取出来的数据进行分析：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ strings 3820.dmp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vn*u</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=Atw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Temp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X=!u</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">~M!u</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=Atw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wow64ApcRoutine</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">......</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="根据-pslist-的结果提取程序本体">根据 pslist 的结果提取程序本体<a href="#根据-pslist-的结果提取程序本体" class="hash-link" aria-label="根据 pslist 的结果提取程序本体的直接链接" title="根据 pslist 的结果提取程序本体的直接链接">​</a></h3>
<p>在一些情况下，我们还需要对程序本体进行逆向分析，但是 memdump 模块输出的数据量太大了，对于仅仅只需要提取程序本体的需求显然不符合，那么就需要用到 procdump 模块。如上文，还是对</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801b486b30 Rick And Morty         3820   2728      4      185      1      1 2018-08-04 19:32:55 UTC+0000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个进程进行操作：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ python2 ./volatility2/vol.py -f OtterCTF.vmem --profile=Win7SP1x64 procdump -p 3820 -D ./</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Volatility Foundation Volatility Framework 2.6.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Process(V)         ImageBase          Name                 Result</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">------------------ ------------------ -------------------- ------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0xfffffa801b486b30 0x0000000000400000 Rick And Morty       OK: executable.3820.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>提取出来的文件名格式为：<code>executable.&lt;pid of process&gt;.&lt;exe/elf&gt;</code></p>
<p>然后便可以对目标进程的程序本体进行逆向分析：</p>
<p><img loading="lazy" alt="Die 分析结果" src="/assets/images/image_20230738-163858-6b90abef4788eb8a54732c9bdd2d6a06.png" width="723" height="464" class="img_ev3q"></p>
<p><img loading="lazy" alt="IDA 分析结果" src="/assets/images/image_20230739-163921-016338f1741aeb80caf4594b5e1a71b4.png" width="1920" height="1050" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="volatility-3-工作流">Volatility 3 工作流<a href="#volatility-3-工作流" class="hash-link" aria-label="Volatility 3 工作流的直接链接" title="Volatility 3 工作流的直接链接">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_BuS1"><p>Volatility 3 改进了模块的工作方式，在相较与 Volatility 2 大大增加了分析速度的同时，也支持自动识别内存镜像的系统版本的特性，也就意味着再也不需要手动指定符号表了</p><p>虽然 Volatility 3 支持自动选择符号表来进行分析工作，但是对于系统种类（Windows，Mac OS，Linux）还是需要自行识别并指定。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="识别系统信息">识别系统信息<a href="#识别系统信息" class="hash-link" aria-label="识别系统信息的直接链接" title="识别系统信息的直接链接">​</a></h3>
<p>首先还是识别一下内存数据的情况：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ vol -f OtterCTF.vmem windows.info</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Volatility 3 Framework 2.0.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Progress:  100.00               PDB scanning finished</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Variable        Value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Kernel Base     0xf80002a52000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DTB     0x187000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Symbols file:///usr/local/lib/python3.10/dist-packages/volatility3/symbols/windows/ntkrnlmp.pdb/3844DBB920174967BE7AA4A2C20430FA-2.json.xz</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Is64Bit True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">IsPAE   False</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">layer_name      0 WindowsIntel32e</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">memory_layer    1 FileLayer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">KdDebuggerDataBlock     0xf80002c430a0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NTBuildLab      7601.17514.amd64fre.win7sp1_rtm.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CSDVersion      1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">KdVersionBlock  0xf80002c43068</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Major/Minor     15.7601</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MachineType     34404</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">KeNumberProcessors      2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">SystemTime      2018-08-04 19:34:22</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NtSystemRoot    C:\Windows</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NtProductType   NtProductWinNt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NtMajorVersion  6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NtMinorVersion  1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PE MajorOperatingSystemVersion  6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PE MinorOperatingSystemVersion  1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PE Machine      34404</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PE TimeDateStamp        Sat Nov 20 09:30:02 2010</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p>以下的操作同 Volatility 2</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="volatility-3-查看进程列表">Volatility 3 查看进程列表<a href="#volatility-3-查看进程列表" class="hash-link" aria-label="Volatility 3 查看进程列表的直接链接" title="Volatility 3 查看进程列表的直接链接">​</a></h3>
<p>同样使用的是 <code>pslist</code> 模块，只不过不需要指定系统信息（符号表）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ vol -f OtterCTF.vmem windows.pslist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Volatility 3 Framework 2.0.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Progress:  100.00               PDB scanning finished</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PID     PPID    ImageFileName   Offset(V)       Threads Handles SessionId       Wow64   CreateTime      ExitTime        File output</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">4       0       System  0xfa8018d44740  95      411     N/A     False   2018-08-04 19:26:03.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">260     4       smss.exe        0xfa801947e4d0  2       30      N/A     False   2018-08-04 19:26:03.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">348     336     csrss.exe       0xfa801a0c8380  9       563     0       False   2018-08-04 19:26:10.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">388     380     csrss.exe       0xfa80198d3b30  11      460     1       False   2018-08-04 19:26:11.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">396     336     wininit.exe     0xfa801a2ed060  3       78      0       False   2018-08-04 19:26:11.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">432     380     winlogon.exe    0xfa801aaf4060  3       113     1       False   2018-08-04 19:26:11.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">492     396     services.exe    0xfa801ab377c0  11      242     0       False   2018-08-04 19:26:12.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">500     396     lsass.exe       0xfa801ab3f060  7       610     0       False   2018-08-04 19:26:12.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">508     396     lsm.exe 0xfa801ab461a0  10      148     0       False   2018-08-04 19:26:12.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">604     492     svchost.exe     0xfa8018e3c890  11      376     0       False   2018-08-04 19:26:16.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">668     492     vmacthlp.exe    0xfa801abbdb30  3       56      0       False   2018-08-04 19:26:16.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">712     492     svchost.exe     0xfa801abebb30  8       301     0       False   2018-08-04 19:26:17.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">808     492     svchost.exe     0xfa801ac2e9e0  22      508     0       False   2018-08-04 19:26:18.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">844     492     svchost.exe     0xfa801ac31b30  17      396     0       False   2018-08-04 19:26:18.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">868     492     svchost.exe     0xfa801ac4db30  45      1114    0       False   2018-08-04 19:26:18.000000      N/A     Disabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">......</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="volatility-3-查看内存中加载了哪些文件">Volatility 3 查看内存中加载了哪些文件<a href="#volatility-3-查看内存中加载了哪些文件" class="hash-link" aria-label="Volatility 3 查看内存中加载了哪些文件的直接链接" title="Volatility 3 查看内存中加载了哪些文件的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ vol -f OtterCTF.vmem windows.filescan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Volatility 3 Framework 2.0.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Progress:  100.00               PDB scanning finished</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Offset  Name    Size</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x5def290       \$Directory     216</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x5df67f0       \Windows\System32       216</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x7d402680      \Nexon\MapleStory\l3codeca.acm  216</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x7d405270      \Users\Rick\AppData\Roaming\BitTorrent\dlimagecache\165F6EF40A81DD175FFAEA69E77ABFD30B27E71C    216</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x7d405d20      \Windows\System32\config\systemprofile\AppData\LocalLow\Microsoft\CryptnetUrlCache\MetaData\DDA81A73291E20E6ACF6CACA76D5C942_4D9486FF3A1DA70CF6B67432FCEC9330   216</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x7d406510      \Windows\assembly\NativeImages_v2.0.50727_32\SMDiagnostics\8218dc4808b77f3585fb048c61597af1\SMDiagnostics.ni.dll        216</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x7d413930      \Windows\Microsoft.NET\Framework64\v2.0.50727\CONFIG\machine.config     216</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x7d414dc0      \Windows\System32\en-US\setupapi.dll.mui        216</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="volatility-3-根据-filescan-的结果提取内存中的文件">Volatility 3 根据 filescan 的结果提取内存中的文件<a href="#volatility-3-根据-filescan-的结果提取内存中的文件" class="hash-link" aria-label="Volatility 3 根据 filescan 的结果提取内存中的文件的直接链接" title="Volatility 3 根据 filescan 的结果提取内存中的文件的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ vol -f OtterCTF.vmem windows.filescan | grep READ_IT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0x7d660500 100.0\Users\Rick\Desktop\READ_IT.txt 216</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ vol -f OtterCTF.vmem windows.dumpfiles --physaddr 0x7d660500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Volatility 3 Framework 2.0.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Progress:  100.00               PDB scanning finished</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Cache   FileObject      FileName        Result</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DataSectionObject       0x7d660500      READ_IT.txt     file.0x7d660500.0xfa801b2def10.DataSectionObject.READ_IT.txt.dat</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">randark@randark-virtual-machine:~$ cat file.0x7d660500.0xfa801b2def10.DataSectionObject.READ_IT.txt.dat</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Your files have been encrypted.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Read the Program for more information</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">read program for more information.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="volatility-2-windows-相关模块">Volatility 2 Windows 相关模块<a href="#volatility-2-windows-相关模块" class="hash-link" aria-label="Volatility 2 Windows 相关模块的直接链接" title="Volatility 2 Windows 相关模块的直接链接">​</a></h2>
<p>TODO Volatility 2 Windows 相关模块</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="volatility-3-windows-相关模块">Volatility 3 Windows 相关模块<a href="#volatility-3-windows-相关模块" class="hash-link" aria-label="Volatility 3 Windows 相关模块的直接链接" title="Volatility 3 Windows 相关模块的直接链接">​</a></h2>
<p>TODO Volatility 3 Windows 相关模块</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="volatility-2-linux-相关模块">Volatility 2 Linux 相关模块<a href="#volatility-2-linux-相关模块" class="hash-link" aria-label="Volatility 2 Linux 相关模块的直接链接" title="Volatility 2 Linux 相关模块的直接链接">​</a></h2>
<p>TODO Volatility 2 Linux 相关模块</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="volatility-3-linux-相关模块">Volatility 3 Linux 相关模块<a href="#volatility-3-linux-相关模块" class="hash-link" aria-label="Volatility 3 Linux 相关模块的直接链接" title="Volatility 3 Linux 相关模块的直接链接">​</a></h2>
<p>TODO Volatility 3 Linux 相关模块</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Randark-JMT/Treasure-House/edit/main/docs/Forensic/Memory-Forensic/Volatility/Volatility-intro.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Forensic/Memory-Forensic/Volatility/Volatility-installation"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Volatility 如何安装</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Forensic/Memory-Forensic/Volatility/Volatility-plugin"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Volatility 插件指南</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#volatility-2-工作流" class="table-of-contents__link toc-highlight">Volatility 2 工作流</a><ul><li><a href="#分析检材类型" class="table-of-contents__link toc-highlight">分析检材类型</a></li><li><a href="#查看进程列表" class="table-of-contents__link toc-highlight">查看进程列表</a></li><li><a href="#查看内存中加载了哪些文件" class="table-of-contents__link toc-highlight">查看内存中加载了哪些文件</a></li><li><a href="#根据-filescan-的结果提取内存中的文件" class="table-of-contents__link toc-highlight">根据 filescan 的结果提取内存中的文件</a></li><li><a href="#根据-pslist-的结果提取程序其可寻址的内存数据" class="table-of-contents__link toc-highlight">根据 pslist 的结果提取程序其可寻址的内存数据</a></li><li><a href="#根据-pslist-的结果提取程序本体" class="table-of-contents__link toc-highlight">根据 pslist 的结果提取程序本体</a></li></ul></li><li><a href="#volatility-3-工作流" class="table-of-contents__link toc-highlight">Volatility 3 工作流</a><ul><li><a href="#识别系统信息" class="table-of-contents__link toc-highlight">识别系统信息</a></li><li><a href="#volatility-3-查看进程列表" class="table-of-contents__link toc-highlight">Volatility 3 查看进程列表</a></li><li><a href="#volatility-3-查看内存中加载了哪些文件" class="table-of-contents__link toc-highlight">Volatility 3 查看内存中加载了哪些文件</a></li><li><a href="#volatility-3-根据-filescan-的结果提取内存中的文件" class="table-of-contents__link toc-highlight">Volatility 3 根据 filescan 的结果提取内存中的文件</a></li></ul></li><li><a href="#volatility-2-windows-相关模块" class="table-of-contents__link toc-highlight">Volatility 2 Windows 相关模块</a></li><li><a href="#volatility-3-windows-相关模块" class="table-of-contents__link toc-highlight">Volatility 3 Windows 相关模块</a></li><li><a href="#volatility-2-linux-相关模块" class="table-of-contents__link toc-highlight">Volatility 2 Linux 相关模块</a></li><li><a href="#volatility-3-linux-相关模块" class="table-of-contents__link toc-highlight">Volatility 3 Linux 相关模块</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">社交联系</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Randark-JMT" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/Randark_JMT" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:randark@foxmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foxmail mail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:randarkjmt@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google mail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">相关项目友链</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/CTF-Archives" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - CTF-Archives<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/CTF-Archives/ctf-docker-template" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub - ctf-docker-template<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/ProbiusOfficial/Hello-CTF" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub - ProbiusOfficial/Hello-CTF<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://blog.probius.xyz/" target="_blank" rel="noopener noreferrer" class="footer__link-item">探姬の星灵枢纽<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="http://www.snowywar.top" target="_blank" rel="noopener noreferrer" class="footer__link-item">雪殇 - snowywar.top<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Treasure-House By Randark-JMT, Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>